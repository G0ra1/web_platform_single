import{d as L,r as m,j as N,u as z,k as C,a,o as I,g as k,b as o,w as n,f,t as A,F as q}from"./runtime-dom.esm-bundler.bf4f36cb.js";import{r as _,ax as U,ay as O,aq as D,ar as V,as as G,aZ as H,b2 as P,f as Q,aw as x,e as R,a as X,b as Y,at as Z,ap as J,k as K,N as W,u as ee,aB as te,_ as oe,m as ne}from"./index.0e7eb3bd.js";import{N as le}from"./Dropdown.c5536ab3.js";function ae(e){return _({url:"/main/jobLog/page",method:"post",data:e})}function se(e){return _({url:`/main/jobLog/${e}`,method:"delete"})}function ue(e){return _({url:`/main/jobLog/clean?jobId=${e}`,method:"get"})}function re(e){return _({url:`/main/dictItem/list?dictCode=${e}`,method:"get"})}const ie=L({components:{NDrawer:U,NDrawerContent:O,NLayout:D,NLayoutHeader:V,NLayoutContent:G,NLayoutFooter:H,NThemeEditor:P,NButton:Q,NInputGroup:x,NInput:R,NForm:X,NFormItem:Y,NPopconfirm:Z,NwTable:J,NSelect:K,NDropdown:le,NSpace:W},setup(){const e=m(null),r=ee();te();const h=m(!1),g=N({}),v=m(null),w=m("\u65B0\u5EFA"),p=t=>{let s=t.map(c=>c.id).join(",");se(s).then(c=>{r.success("\u5220\u9664"),e.value.commitQuery(),e.value.clearSelected()})},b=()=>{ue(d.jobId||"").then(t=>{r.success("\u6E05\u7A7A\u6210\u529F"),e.value.commitQuery()})},i=()=>{if(console.log(location),console.log(location.search),!location.search.split("?")[1])return{};try{let t={};return location.search.split("?")[1].split("&").forEach(s=>{t[s.split("=")[0]]=s.split("=")[1]}),t}catch(t){return console.log(t),{}}},d=i();return z(()=>{console.log(d.value,"onMountedonMountedonMounted"),console.log(i(),"onMountedonMountedonMounted")}),{message:r,contentTile:w,getHtmlQuery:i,htmlQuery:d,formVisible:h,formValue:{},dictItemLists:re,Form:v,handDel:p,handClear:b,model:g,request:{XHR:ae,params:{jobId:d.jobId},pageMethod:(t,s)=>({page:{current:t,size:s}})},response:{dataMethod:t=>t.records,pageMethod:({total:t})=>t},nwTable:e,columns:N([{type:"checkbox",width:35},{type:"seq",width:40},{field:"bizSysCode",title:"\u5B50\u7CFB\u7EDF"},{field:"jobName",title:"\u4EFB\u52A1\u540D\u79F0",showOverflow:!0},{field:"invokeTarget",title:"\u8C03\u7528\u76EE\u6807\u5B57\u7B26\u4E32",showOverflow:!0},{field:"jobMessage",title:"\u65E5\u5FD7\u4FE1\u606F",showOverflow:!0},{field:"status",title:"\u6267\u884C\u72B6\u6001",showOverflow:!0,slots:{default:({row:t})=>[C("span",null,t.status==0?"\u6B63\u5E38":"\u5931\u8D25")]}},{field:"startTime",title:"\u5F00\u59CB\u65E5\u671F",showOverflow:!0},{field:"endTime",title:"\u7ED3\u675F\u65E5\u671F",showOverflow:!0},{fielf:"",title:"\u64CD\u4F5C",showOverflow:!0,slots:{default:({row:t})=>[C("a",{style:"color:#2d8cf0;cursor: pointer;",onClick:s=>{window.open(`/html/mdm/log-current.html?appName=${t.bizSysCode}&startCreateTime=${t.startTime}&endCreateTime=${t.endTime}`)}},"\u67E5\u770B\u65E5\u5FD7\u76D1\u63A7")]}}])}},created(){},methods:{show(){this.$refs.nwTable.toggleSearchForm()}}});function de(e,r,h,g,v,w){const p=a("n-button"),b=a("n-popconfirm"),i=a("n-space"),d=a("n-layout-header"),t=a("nw-dictionary"),s=a("n-form-item"),c=a("n-input"),y=a("n-select"),E=a("n-form"),j=a("NwTable"),F=a("n-layout-content"),T=a("n-layout"),$=a("n-drawer-content"),M=a("n-drawer");return I(),k(q,null,[o(T,{class:"nw-layout-full"},{default:n(()=>[o(d,null,{default:n(()=>[o(i,{size:5,style:{padding:"0 5px"}},{default:n(()=>[o(b,{onPositiveClick:r[0]||(r[0]=l=>e.handClear()),"positive-text":"\u786E\u5B9A","negative-text":"\u53D6\u6D88"},{trigger:n(()=>[o(p,{type:"error",size:"small"},{default:n(()=>[f("\u6E05\u7A7A")]),_:1})]),default:n(()=>[f(" "+A("\u662F\u5426\u786E\u5B9A\u6E05\u7A7A\u6570\u636E"))]),_:1})]),_:1}),o(i,{size:5,style:{padding:"0 5px"}})]),_:1}),o(F,{class:"nw-layout-full"},{default:n(()=>[o(j,{ref:"nwTable",columns:e.columns,data:null,request:e.request,response:e.response,searchFormFields:[{field:"roleName",title:"name",valueFormat:l=>l}]},{"search-form":n(({searchFormData:l})=>[o(E,{model:l},{default:n(()=>[o(s,{label:"\u5B50\u7CFB\u7EDF",path:"bizSysCodes"},{default:n(()=>[o(t,{request:{XHR:e.dictItemLists,params:"APP_NAME"},value:l.bizSysCodesList,"onUpdate:value":[u=>l.bizSysCodesList=u,u=>{l.bizSysCodes=u.join(",")}],multiple:"",response:{dataMethod:u=>u.map(({dictItemCode:B,dictItemName:S})=>({label:S,value:B}))}},null,8,["request","value","onUpdate:value","response"])]),_:2},1024),o(s,{label:"\u4EFB\u52A1\u540D\u79F0",path:"jobName"},{default:n(()=>[o(c,{placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0",value:l.jobName,"onUpdate:value":u=>l.jobName=u},null,8,["value","onUpdate:value"])]),_:2},1024),o(s,{label:"\u4EFB\u52A1\u7EC4\u540D",path:"jobGroup"},{default:n(()=>[o(y,{value:l.jobGroup,"onUpdate:value":u=>l.jobGroup=u,options:[{label:"\u9ED8\u8BA4",value:"DEFAULT"},{label:"\u7CFB\u7EDF",value:"SYSTEM"}]},null,8,["value","onUpdate:value"])]),_:2},1024),o(s,{label:"\u4EFB\u52A1\u72B6\u6001",path:"status"},{default:n(()=>[o(y,{value:l.status,"onUpdate:value":u=>l.status=u,options:[{label:"\u6B63\u5E38",value:0},{label:"\u6682\u505C",value:1}]},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1032,["model"])]),_:1},8,["columns","request","response","searchFormFields"])]),_:1})]),_:1}),o(M,{show:e.formVisible,width:"100%",height:200,placement:"right",to:e.$refs.page&&e.$refs.page.$el},{default:n(()=>[o($,{title:e.contentTile,"header-style":{padding:"10px","font-size":"16px","font-weight":"bold"},"footer-style":{padding:"10px"}},{footer:n(()=>[o(p,{style:{"margin-right":"5px"},size:"small",onClick:r[1]||(r[1]=l=>e.formVisible=!1)},{default:n(()=>[f("\u53D6\u6D88")]),_:1}),o(p,{type:"info",size:"small",onClick:e.handleSave},{default:n(()=>[f("\u4FDD\u5B58")]),_:1},8,["onClick"])]),_:1},8,["title"])]),_:1},8,["show","to"])],64)}const pe=oe(ie,[["render",de]]);ne(pe).mount("#app");
