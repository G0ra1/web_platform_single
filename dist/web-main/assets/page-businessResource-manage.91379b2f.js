import{d as A,r as c,k as F,p as $,a as s,o as R,g as q,b as o,w as n,f as g,h as B,K as P,F as O,_ as W,$ as X,c as Y,u as Z}from"./runtime-dom.esm-bundler.bf4f36cb.js";import{aH as I,aq as T,aA as V,ar as K,as as J,f as k,N as U,i as E,an as S,e as z,aw as G,ax as H,ay as L,ak as ee,aI as j,aE as x,aF as Q,_ as M,am as oe,k as ae,a as ne,b as te,c as le,aJ as se,aK as re,aL as ie,l as pe,aB as ue,m as de}from"./index.0e7eb3bd.js";import{N as me}from"./index.8affa40d.js";import{N as fe}from"./index.cb0cc583.js";import{N as ce}from"./InputGroupLabel.f8867056.js";import{N as _e}from"./FormItemGridItem.5c201774.js";function ve(e){return new I("/permission/businessResource","post",e).send()}function ge(e){return new I("/permission/businessResource","put",e).send()}function ye(e){return new I(`/permission/businessResource/${e}`,"delete").send()}const we=A({props:{type:{type:String,default:"1"}},components:{NLayout:T,NLayoutSider:V,NLayoutHeader:K,NLayoutContent:J,NButton:k,NSpace:U,NwIcon:E,NTag:S,NInput:z,NInputGroup:G,NDrawer:H,NDrawerContent:L,NModal:ee,NwAppTreeGrid:j},setup(e,a){const d=c({appCode:""}),_=c(!1),{bind:y,gridRef:w,filterData:m,query:p,reset:i}=new x.VxeGridPaging({height:"400px",columns:[{field:"roleName",title:"\u540D\u79F0",showHeaderOverflow:!0,width:"180px"},{field:"roleCode",title:"\u7F16\u7801",showHeaderOverflow:!0,width:"210px"},{title:"\u64CD\u4F5C",showHeaderOverflow:!0,width:"50px",slots:{default:({row:l})=>[F(k,{size:"tiny",type:"primary",onClick:()=>{a.emit("update:value",l.id,l),a.emit("update:roleCode",l.roleCode),a.emit("update:roleName",l.roleName),_.value=!1}},{default:()=>"\u9009\u62E9"})]}}]},new Q("/main/mdmRole/list","post"));$().then(()=>{});const r=()=>{i({pageType:"2",appCode:d.value.appCode})};return{visible:_,bind:y,gridRef:w,filterData:m,query:p,reset:i,show(){_.value=!0,$().then(()=>{r()})},selectApp(l){console.log(l),l.appType===2?d.value=l:l.appType===0&&(d.value={appCode:""}),r()}}}});const Ne=e=>(W("data-v-4a35f46c"),e=e(),X(),e),Ce=Ne(()=>B("div",null," \u9009\u62E9\u9875\u9762 ",-1)),he={style:{padding:"5px"}};function be(e,a,d,_,y,w){const m=s("n-button"),p=s("nw-icon"),i=s("NwAppTreeGrid"),r=s("n-layout-sider"),l=s("n-space"),v=s("n-input"),h=s("n-input-group"),b=s("n-layout-header"),N=s("vxe-grid"),C=s("n-layout-content"),f=s("n-layout"),t=s("n-modal");return R(),q(O,null,[o(m,{onClick:e.show},{default:n(()=>[g(" \u9009\u62E9 ")]),_:1},8,["onClick"]),o(t,{class:"nw-modal",show:e.visible,"onUpdate:show":a[4]||(a[4]=u=>e.visible=u),preset:"dialog",style:{width:"800px",padding:"0"},"show-icon":!0,"mask-closable":!0,closable:!0},{icon:n(()=>[o(p,{name:"icon-biaodan",size:20,color:"rgb(103, 194, 58)"})]),header:n(()=>[Ce]),action:n(()=>[B("div",he,[o(m,{size:"small",onClick:a[3]||(a[3]=u=>e.visible=!1)},{default:n(()=>[g("\u53D6\u6D88")]),_:1})])]),default:n(()=>[o(f,{"has-sider":"",class:"nw-layout-full"},{default:n(()=>[o(r,{width:"250"},{default:n(()=>[o(i,{rootName:"\u5168\u90E8",onCallback:e.selectApp},null,8,["onCallback"])]),_:1}),o(f,null,{default:n(()=>[o(b,null,{default:n(()=>[o(l,{size:5,style:{padding:"0 5px"}}),o(l,{size:5,style:{padding:"0 5px"}},{default:n(()=>[o(h,null,{default:n(()=>[o(v,{value:e.filterData.formNameCh||"","onUpdate:value":a[0]||(a[0]=u=>e.filterData.formNameCh=u),placeholder:"\u8F93\u5165\u67E5\u8BE2\u6587\u672C",style:{width:"150px"}},null,8,["value"]),o(m,{type:"primary",onClick:a[1]||(a[1]=u=>e.query())},{default:n(()=>[g(" \u641C\u7D22 ")]),_:1})]),_:1}),o(m,{title:"\u91CD\u7F6E",type:"warning",onClick:a[2]||(a[2]=u=>e.reset())},{icon:n(()=>[o(p,{name:"icon-n-y-refresh"})]),_:1})]),_:1})]),_:1}),o(C,null,{default:n(()=>[o(N,P(e.bind,{ref:"gridRef"}),null,16)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])],64)}const ke=M(we,[["render",be],["__scopeId","data-v-4a35f46c"]]),De=A({components:{NLayout:T,NButton:k,NSpace:U,NSpin:oe,NwIcon:E,NTag:S,NInput:z,NInputGroup:G,NInputGroupLabel:ce,NSelect:ae,NDrawer:H,NDrawerContent:L,NForm:ne,NFormItem:te,NGrid:le,NFormItemGi:_e,NDivider:se,NSwitch:re,NwSchemaEditor:me,NwCodeMirror:ie,NwPickPage:fe,PickRole:ke},setup(e,a){const d=c(!1),_=c(),y=c(!1),w=c(""),m=c(),p=c("create"),i=c(!1),r={},l=c({});return{loading:d,formRef:_,rules:{pageName:{required:!0,message:"\u8BF7\u9009\u62E9\u4E1A\u52A1\u53F0\u8D26",trigger:["input","blur"]},conditionalExpression:{required:!0,message:"\u8BF7\u8F93\u5165\u6761\u4EF6\u8868\u8FBE\u5F0F",trigger:["input","blur"]}},show:(f,t)=>{i.value=!0,f?(p.value="edit",l.value=f):(console.log(t,"appInfo"),p.value="create",l.value=pe.exports.cloneDeep(r),l.value.appCode=t.appCode,l.value.appName=t.appName,l.value.appId=t.appId)},submit:async()=>{console.log("======formData.value=======",l.value),_.value.validate().then((...f)=>{d.value=!0,p.value==="create"?(console.log("====formData======",l.value),ve(l.value).then(t=>{console.log("====r====",t),i.value=!1,a.emit("callback")}).finally(()=>{d.value=!1})):p.value==="edit"&&ge(l.value).then(t=>{console.log("====r====",t),i.value=!1,a.emit("callback")}).finally(()=>{d.value=!1})})},cancel:()=>{i.value=!1},active:i,formData:l,iframeActive:y,iframeUrl:w,iframeRef:m,updateForm:(f,t)=>{l.value.formListUrl=t.formListUrl,l.value.formListMethodType=t.formListMethodType,l.value.pageId=t.id},updateRole:(f,t)=>{l.value.roleName=t.roleName,l.value.roleCode=t.roleCode,l.value.roleId=t.id}}}});const Fe=["src"];function $e(e,a,d,_,y,w){const m=s("nw-icon"),p=s("n-input"),i=s("nw-pick-page"),r=s("n-form-item-gi"),l=s("pick-role"),v=s("n-grid"),h=s("n-form"),b=s("n-spin"),N=s("n-button"),C=s("n-drawer-content"),f=s("n-drawer");return R(),Y(f,{show:e.active,"onUpdate:show":a[13]||(a[13]=t=>e.active=t),width:"100%",placement:"right"},{default:n(()=>[o(C,null,{header:n(()=>[o(m,{style:{"margin-right":"5px"},size:25,name:"icon-n-y-newpage"}),g(" \u6743\u9650\u914D\u7F6E ")]),footer:n(()=>[o(N,{onClick:a[9]||(a[9]=t=>e.submit()),type:"primary",style:{"margin-right":"5px"}},{default:n(()=>[g(" \u63D0\u4EA4 ")]),_:1}),o(N,{onClick:a[10]||(a[10]=t=>e.active=!1)},{default:n(()=>[g(" \u53D6\u6D88 ")]),_:1})]),default:n(()=>[o(b,{show:e.loading},{default:n(()=>[o(h,{ref:"formRef",model:e.formData,"label-width":"auto","label-align":"left","label-placement":"left",style:{width:"600px",padding:"50px 0",margin:"0 auto"},rules:e.rules},{default:n(()=>[o(v,{cols:24,"x-gap":24},{default:n(()=>[o(r,{span:24,label:"\u4E1A\u52A1\u53F0\u8D26",path:"pageName"},{default:n(()=>[o(p,{placeholder:"\u9009\u62E9\u4E1A\u52A1\u53F0\u8D26",value:e.formData.pageName,"onUpdate:value":a[0]||(a[0]=t=>e.formData.pageName=t)},null,8,["value"]),o(i,{"onUpdate:value":a[1]||(a[1]=(t,u)=>e.updateForm(t,u)),"onUpdate:pageCode":a[2]||(a[2]=t=>e.formData.pageCode=t),"onUpdate:pageName":a[3]||(a[3]=t=>e.formData.pageName=t)})]),_:1}),o(r,{span:24,label:"\u6240\u5C5E\u5E94\u7528",path:"appCode"},{default:n(()=>[o(p,{disabled:"",style:{width:"50%"},placeholder:"\u8F93\u5165App\u540D\u79F0",value:e.formData.appName,"onUpdate:value":a[4]||(a[4]=t=>e.formData.appName=t)},null,8,["value"]),o(p,{disabled:"",style:{width:"50%"},placeholder:"\u8F93\u5165App\u7F16\u7801",value:e.formData.appCode,"onUpdate:value":a[5]||(a[5]=t=>e.formData.appCode=t)},null,8,["value"])]),_:1}),o(r,{span:24,label:"\u9009\u62E9\u89D2\u8272",path:"roleName"},{default:n(()=>[o(p,{placeholder:"\u9009\u62E9\u89D2\u8272",value:e.formData.roleName,"onUpdate:value":a[6]||(a[6]=t=>e.formData.roleName=t)},null,8,["value"]),o(l,{"onUpdate:value":a[7]||(a[7]=(t,u)=>e.updateRole(t,u))})]),_:1}),o(r,{span:24,label:"\u8868\u8FBE\u5F0F",path:"conditionalExpression"},{default:n(()=>[o(p,{type:"textarea",placeholder:"\u8868\u8FBE\u5F0F",value:e.formData.conditionalExpression,"onUpdate:value":a[8]||(a[8]=t=>e.formData.conditionalExpression=t)},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show"]),o(f,{show:e.iframeActive,"onUpdate:show":a[12]||(a[12]=t=>e.iframeActive=t),width:800},{default:n(()=>[o(C,{title:"\u9884\u89C8\u8868\u5355"},{footer:n(()=>[o(N,{onClick:a[11]||(a[11]=t=>e.iframeActive=!1)},{default:n(()=>[g(" \u5173\u95ED ")]),_:1})]),default:n(()=>[B("iframe",{ref:"iframeRef",src:e.iframeUrl,style:{display:"block",width:"100%",height:"100%",border:"none"}},null,8,Fe)]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["show"])}const Ae=M(De,[["render",$e],["__scopeId","data-v-765aa4e2"]]),Re=A({components:{NLayout:T,NLayoutSider:V,NLayoutHeader:K,NLayoutContent:J,NButton:k,NSpace:U,NwIcon:E,NTag:S,NInput:z,NInputGroup:G,NDrawer:H,NDrawerContent:L,ModalBasicForm:Ae,NwAppTreeGrid:j},setup(){const e=c({appCode:""}),a=ue(),d=c(),_=()=>{p()};Z(()=>{});const{bind:y,gridRef:w,filterData:m,query:p,reset:i}=new x.VxeGridPaging({columns:[{field:"pageName",title:"\u4E1A\u52A1\u540D\u79F0",showHeaderOverflow:!0},{field:"pageCode",title:"\u4E1A\u52A1\u7F16\u7801",showHeaderOverflow:!0},{field:"roleName",title:"\u89D2\u8272\u540D\u79F0",showHeaderOverflow:!0},{title:"\u64CD\u4F5C",showHeaderOverflow:!0,width:"230px",slots:{default:({row:l})=>[F(k,{size:"tiny",style:"margin-right: 5px;",onClick:()=>{var v;(v=d.value)==null||v.show(l)}},{default:()=>"\u7F16\u8F91"}),F(k,{size:"tiny",type:"error",onClick:()=>{a.error({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u53D6\u6D88",maskClosable:!1,onMaskClick:()=>{},onPositiveClick:()=>{ye(l.id).then(v=>{r()})}})}},{default:()=>"\u5220\u9664"})]}}]},new Q("/permission/businessResource/pageByBusiness","post"));$().then(()=>{r()});const r=()=>{i({appCode:e.value.appCode})};return{modalBasicFormRef:d,bind:y,gridRef:w,filterData:m,query:p,appInfo:e,saveSuccess:_,handleTree(l){l.appType===2?e.value=l:l.appType===0&&(e.value={appCode:""}),r()},refresh:r}}});function Be(e,a,d,_,y,w){const m=s("nw-app-tree-grid"),p=s("n-layout-sider"),i=s("nw-icon"),r=s("n-button"),l=s("n-space"),v=s("n-input"),h=s("n-input-group"),b=s("n-layout-header"),N=s("vxe-grid"),C=s("n-layout-content"),f=s("n-layout"),t=s("ModalBasicForm");return R(),q(O,null,[o(f,{"has-sider":"",class:"nw-layout-full"},{default:n(()=>[o(p,{bordered:"",width:"225","content-style":"padding: 5px;",style:{"margin-right":"-1px"}},{default:n(()=>[o(m,{rootName:"\u5168\u90E8",onCallback:e.handleTree},null,8,["onCallback"])]),_:1}),o(f,{class:"nw-layout-full"},{default:n(()=>[o(b,{class:"nw-layout-header"},{default:n(()=>[o(l,{size:5,style:{padding:"0 5px"}},{default:n(()=>[o(r,{disabled:!e.appInfo.appCode,type:"primary",onClick:a[0]||(a[0]=u=>{var D;return(D=e.modalBasicFormRef)==null?void 0:D.show("",e.appInfo)})},{icon:n(()=>[o(i,{name:"icon-n-y-add",size:14})]),default:n(()=>[g(" \u65B0\u589E\u6743\u9650 ")]),_:1},8,["disabled"])]),_:1}),o(l,{size:5,style:{padding:"0 5px"}},{default:n(()=>[o(h,null,{default:n(()=>[o(v,{value:e.filterData.formNameCh||"","onUpdate:value":a[1]||(a[1]=u=>e.filterData.formNameCh=u),placeholder:"\u8F93\u5165\u67E5\u8BE2\u6587\u672C",style:{width:"150px"}},null,8,["value"]),o(r,{type:"primary",onClick:a[2]||(a[2]=u=>e.query())},{default:n(()=>[g(" \u641C\u7D22 ")]),_:1})]),_:1}),o(r,{title:"\u91CD\u7F6E",type:"warning",onClick:a[3]||(a[3]=u=>e.refresh())},{icon:n(()=>[o(i,{name:"icon-n-y-refresh"})]),_:1}),o(r,{title:"\u5BFC\u5165"},{icon:n(()=>[o(i,{name:"icon-n-y-import"})]),_:1}),o(r,{title:"\u5BFC\u51FA"},{icon:n(()=>[o(i,{name:"icon-n-y-export"})]),_:1}),o(r,{title:"\u6253\u5370",onClick:a[4]||(a[4]=u=>{var D;return(D=e.gridRef)==null?void 0:D.print()})},{icon:n(()=>[o(i,{name:"icon-n-y-print"})]),_:1}),o(r,null,{icon:n(()=>[o(i,{name:"icon-n-y-column"})]),_:1})]),_:1})]),_:1}),o(C,null,{default:n(()=>[o(N,P(e.bind,{ref:"gridRef"}),null,16)]),_:1})]),_:1})]),_:1}),o(t,{ref:"modalBasicFormRef",onCallback:e.saveSuccess},null,8,["onCallback"])],64)}const Ie=M(Re,[["render",Be],["__scopeId","data-v-1ae44c87"]]);de(Ie).mount("#app");
