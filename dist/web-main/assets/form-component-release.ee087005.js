var z=Object.defineProperty;var I=(e,a,r)=>a in e?z(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;var n=(e,a,r)=>(I(e,typeof a!="symbol"?a+"":a,r),r);import{r as v,d as $,a as s,o as m,c as f,w as t,b as l,e as c,f as w,t as D,g as A,h as b,n as R}from"./runtime-dom.esm-bundler.bf4f36cb.js";import{C as E,l as T,r as V,N as j,a as q,b as G,c as L,d as P,e as O,f as H,g as J,h as X,i as K,j as Q,k as W,u as Y,_ as Z,m as x}from"./index.0e7eb3bd.js";import{A as ee}from"./index.3c25c870.js";import{N as ae,a as te}from"./Upload.3acdeec3.js";import{N as le}from"./text.c79655f7.js";import{N as oe}from"./Image.316697df.js";import{N as re}from"./FormItemGridItem.5c201774.js";import{N as ne}from"./InputNumber.39ec7792.js";import"./Add.f7b12907.js";const se={widgetName:{name:"widgetName",type:"string",description:"\u7EC4\u4EF6\u540D\u79F0",example:"",exampleSetFlag:!0},widgetCode:{name:"widgetCode",type:"string",description:"\u7EC4\u4EF6\u7F16\u7801",example:"",exampleSetFlag:!0},widgetUrl:{name:"widgetUrl",type:"string",description:"\u7EC4\u4EF6\u8DEF\u5F84",example:"",exampleSetFlag:!0},widgetTypeName:{name:"widgetTypeName",type:"string",description:"\u7EC4\u4EF6\u7C7B\u578B\u540D\u79F0",example:"",exampleSetFlag:!0},widgetTypeCode:{name:"widgetTypeCode",type:"string",description:"\u7EC4\u4EF6\u7C7B\u578Bcode",example:"",exampleSetFlag:!0},reason:{name:"reason",type:"string",description:"\u8BF4\u660E",example:"",exampleSetFlag:!0},coverUrl:{name:"coverUrl",type:"string",description:"\u5C01\u9762",example:"",exampleSetFlag:!0}};class de extends ee{constructor(){super();n(this,"formRef",v());n(this,"dataModel",v({}));n(this,"rules",v({}));n(this,"brules",v({}));n(this,"token",E.get("token"));n(this,"tokenType",E.get("tokenType"));n(this,"getSchema",async()=>se);n(this,"setValue",r=>{this.dataModel.value=T.exports.cloneDeep(r)});n(this,"getValue",async()=>T.exports.cloneDeep(this.dataModel.value));n(this,"setRules",r=>{this.rules.value={},Object.entries(r).forEach(([d,i])=>{d.includes(".")||(i.powerCode==="required"?this.rules.value[d]={required:!0,trigger:["blur","input"],message:`${i.nameCh}\u8BE5\u5C5E\u6027\u4E3A\u5FC5\u586B`}:this.brules.value[d]=i.powerCode)})});n(this,"validate",async()=>{var d;let r=[];return await((d=this.formRef.value)==null?void 0:d.validate().then(()=>{r=[]}).catch(i=>{r=i.map(N=>N[0].message)})),r})}}function ie(e){return V({url:`/main/dictItem/list?dictCode=${e}`,method:"get"})}const ue=$({components:{NSpace:j,NForm:q,NFormItem:G,NGrid:L,NGridItem:P,NFormItemGi:re,NInput:O,NInputNumber:ne,NButton:H,NDatePicker:J,NUpload:ae,NUploadDragger:te,NIcon:X,NText:le,NwIcon:K,NwDic:Q,NImage:oe,NSelect:W},setup(){const{formRef:e,dataModel:a,rules:r,brules:d,token:i,tokenType:N,setValue:C,getValue:p,validate:u,setRules:S}=new de,y=Y(),h=v(""),U=v("small");return{formRef:e,dataModel:a,token:i,tokenType:N,rules:r,brules:d,validate:u,dictItemLists:ie,message:y,uploadUrl:`${window.apiBaseURL}/main/fileinfo?fileSource=portal`,async beforeUpload(){},handleFinish(F){let{code:g,data:_,msg:k}=JSON.parse(F.event.target.response);g==200?(y.success("\u4E0A\u4F20\u6210\u529F"),a.value.coverUrl=_.fileUrl):y.error(k)},handlePreview(){h.value=a.value.widgetUrl},previewUrl:h,previewSize:U}}});const pe={key:1},me={style:{display:"flex","justify-content":"space-between",width:"200px","margin-bottom":"10px"}},ge=["src"];function fe(e,a,r,d,i,N){const C=s("n-input"),p=s("n-form-item"),u=s("n-grid-item"),S=s("nw-dic"),y=s("n-upload-dragger"),h=s("n-upload"),U=s("n-image"),F=s("nw-icon"),g=s("n-button"),_=s("n-space"),k=s("n-grid"),B=s("n-form");return m(),f(B,{model:e.dataModel,ref:"formRef",style:{padding:"0 10px"},rules:e.rules},{default:t(()=>[l(k,{"x-gap":"8",cols:2},{default:t(()=>[e.brules.widgetName!=="hide"?(m(),f(u,{key:0,span:"2"},{default:t(()=>[l(p,{path:"widgetName",label:"\u7EC4\u4EF6\u540D\u79F0"},{default:t(()=>[l(C,{disabled:e.brules.widgetName==="readonly",value:e.dataModel.widgetName,"onUpdate:value":a[0]||(a[0]=o=>e.dataModel.widgetName=o),placeholder:""},null,8,["disabled","value"])]),_:1})]),_:1})):c("",!0),e.brules.widgetUrl!=="hide"?(m(),f(u,{key:1},{default:t(()=>[l(p,{path:"widgetUrl",label:"\u7EC4\u4EF6\u8DEF\u5F84"},{default:t(()=>[l(C,{disabled:e.brules.widgetUrl==="readonly",value:e.dataModel.widgetUrl,"onUpdate:value":a[1]||(a[1]=o=>e.dataModel.widgetUrl=o),placeholder:""},null,8,["disabled","value"])]),_:1})]),_:1})):c("",!0),e.brules.widgetTypeCode!=="hide"?(m(),f(u,{key:2},{default:t(()=>[l(p,{path:"widgetTypeCode",label:"\u7EC4\u4EF6\u7C7B\u578B"},{default:t(()=>[l(S,{disabled:e.brules.widgetTypeCode==="readonly",value:e.dataModel.widgetTypeCode,"onUpdate:value":a[2]||(a[2]=o=>e.dataModel.widgetTypeCode=o),label:e.dataModel.widgetTypeName,"onUpdate:label":a[3]||(a[3]=o=>e.dataModel.widgetTypeName=o),size:"small",request:{XHR:e.dictItemLists,params:"widgets-type"},response:{dataMethod:o=>o.map(M=>({value:M.dictItemCode,label:M.dictItemName}))},placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},null,8,["disabled","value","label","request","response"])]),_:1})]),_:1})):c("",!0),e.brules.reason!=="hide"?(m(),f(u,{key:3,span:24},{default:t(()=>[l(p,{path:"reason",label:"\u8BF4\u660E"},{default:t(()=>[l(C,{disabled:e.brules.reason==="readonly",value:e.dataModel.reason,"onUpdate:value":a[4]||(a[4]=o=>e.dataModel.reason=o),type:"textarea","show-count":"",placeholder:""},{count:t(({value:o})=>[w(D(o.length),1)]),_:1},8,["disabled","value"])]),_:1})]),_:1})):c("",!0),l(u,{span:24},{default:t(()=>[l(p,{path:"coverUrl",label:"\u5C01\u9762\u4E0A\u4F20"},{default:t(()=>[e.dataModel.coverUrl?c("",!0):(m(),f(h,{key:0,action:e.uploadUrl,accept:"image/png, image/jpeg, image/bmp","show-file-list":!1,headers:{Authorization:`${e.tokenType} ${e.token}`},data:{},onFinish:a[5]||(a[5]=o=>e.handleFinish(o)),onBeforeUpload:e.beforeUpload},{default:t(()=>[l(y,null,{default:t(()=>[w(" \u5EFA\u8BAE\u4E0A\u4F20jpg\u3001png\u683C\u5F0F\u7684\u56FE\u7247 ")]),_:1})]),_:1},8,["action","headers","onBeforeUpload"])),e.dataModel.coverUrl?(m(),A("div",pe,[l(U,{src:`http://incloud.com/${e.dataModel.coverUrl}`,height:"50",width:"50",style:{"padding-left":"15px"}},null,8,["src"]),l(F,{onClick:a[6]||(a[6]=()=>{e.dataModel.coverUrl=""}),name:"icon-n-y-shanchu",style:{cursor:"pointer",position:"absolute",left:"70px",top:"35px",color:"red"},size:"{15}"})])):c("",!0)]),_:1})]),_:1}),l(u,{span:24},{default:t(()=>[l(p,null,{label:t(()=>[]),default:t(()=>[b("div",null,[b("div",me,[b("div",null,[l(g,{type:"info",onClick:e.handlePreview},{default:t(()=>[w(" \u9884\u89C8")]),_:1},8,["onClick"])]),l(_,{align:"center"},{default:t(()=>[l(g,{text:e.previewSize!=="large",onClick:a[7]||(a[7]=o=>e.previewSize="large")},{default:t(()=>[w(" \u5927")]),_:1},8,["text"]),l(g,{text:e.previewSize!=="normal",onClick:a[8]||(a[8]=o=>e.previewSize="normal")},{default:t(()=>[w(" \u4E2D")]),_:1},8,["text"]),l(g,{text:e.previewSize!=="small",onClick:a[9]||(a[9]=o=>e.previewSize="small")},{default:t(()=>[w(" \u5C0F")]),_:1},8,["text"])]),_:1})]),b("div",null,[b("iframe",{class:R({"preview-iframe":!0,large:e.previewSize==="large",normal:e.previewSize==="normal",small:e.previewSize==="small"}),src:e.previewUrl},null,10,ge)])])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])}const ce=Z(ue,[["render",fe],["__scopeId","data-v-b62ea396"]]);x(ce).mount("#app");
