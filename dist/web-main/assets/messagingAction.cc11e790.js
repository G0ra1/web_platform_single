import{ak as D,e as U,a as $,b as S,c as F,d as I,al as z,k as A,az as x,am as E,f as B,aU as G,_ as L,er as V,es as H,et as J,eu as K,an as O,j as Q,i as W,ao as X,aP as Y,ev as Z,ds as ee,a$ as te,u as oe,l as le,ew as ne}from"./index.0e7eb3bd.js";import{d as P,r,a,o as q,c as ae,w as o,b as t,f as u,h as k,t as se,u as ie,i as T,g as re,F as de}from"./runtime-dom.esm-bundler.bf4f36cb.js";import{N as me}from"./Image.316697df.js";import{N as pe}from"./text.c79655f7.js";import{N as ue}from"./p.0c502c64.js";const fe=P({components:{NModal:D,NInput:U,NForm:$,NFormItem:S,NGrid:F,NGridItem:I,NTreeSelect:z,NSelect:A,NTree:x,NSpin:E,NButton:B,NEllipsis:G},props:{},setup(e,l){const v=r(!1),h=r(!1),_=r({}),y=r(!1),p=r(),f=r([]),d=r([]),g=r({}),c=(n={})=>{v.value=!0,m()},i=n=>{V().then(N=>{m()})},m=()=>{y.value=!0,H({...g.value}).then(n=>{d.value=n,y.value=!1})};return{sonFn:c,showModal:v,spinShow:y,xTable:p,formData:_,tempLists:d,del:i,isAddedByEmpId:n=>f.map(N=>N.id).includes(n),actionModal:h,formBtn:()=>{(_.value.id?J:K)({..._.value}).then(N=>{m(),h.value=!1})},currentChangeEvent:n=>{v.value=!1,l.emit("update:callback",n)},getList:m,SearchForm:g}},methods:{}}),ce={style:{height:"40px",width:"100%","line-height":"40px"}};function ge(e,l,v,h,_,y){const p=a("n-button"),f=a("n-space"),d=a("n-input"),g=a("n-form-item"),c=a("n-form"),i=a("vxe-table-column"),m=a("n-ellipsis"),b=a("vxe-button"),M=a("vxe-table"),w=a("n-modal");return q(),ae(w,{show:e.showModal,"onUpdate:show":l[9]||(l[9]=n=>e.showModal=n),"mask-closable":!1,class:"employee",preset:"dialog",title:"\u9009\u62E9\u6A21\u677F",content:"\u4F60\u786E\u8BA4","positive-text":"\u786E\u8BA4","negative-text":"\u53D6\u6D88",style:{width:"1200px"}},{action:o(()=>[t(p,{type:"warning",size:"small",onClick:l[4]||(l[4]=n=>e.showModal=!1)},{default:o(()=>[u("\u53D6\u6D88")]),_:1}),t(p,{type:"success",size:"small",style:{"margin-right":"5px"},onClick:e.onPositiveClick},{default:o(()=>[u("\u4FDD\u5B58")]),_:1},8,["onClick"])]),default:o(()=>[k("div",ce,[t(f,{size:5},{default:o(()=>[t(p,{type:"info","attr-type":"button",style:{"margin-right":"5px"},onClick:l[0]||(l[0]=()=>{e.actionModal=!0})},{default:o(()=>[u(" \u65B0\u5EFA ")]),_:1})]),_:1}),t(f,{size:5,style:{padding:"0 5px",position:"absolute",right:"0"}},{default:o(()=>[t(c,{ref:"formRef",inline:"","label-placement":"left","label-width":80,model:e.SearchForm,style:{height:"30px"}},{default:o(()=>[t(g,{label:"\u6807\u9898",path:"tempTitle"},{default:o(()=>[t(d,{placeholder:"\u6807\u9898",value:e.SearchForm.tempTitle,"onUpdate:value":l[1]||(l[1]=n=>e.SearchForm.tempTitle=n)},null,8,["value"])]),_:1}),t(g,null,{default:o(()=>[t(p,{type:"info","attr-type":"button",style:{"margin-right":"5px"},onClick:l[2]||(l[2]=()=>{e.getList()})},{default:o(()=>[u(" \u67E5\u8BE2 ")]),_:1}),t(p,{type:"warning","attr-type":"button",onClick:l[3]||(l[3]=()=>{e.SearchForm={},e.getList()})},{default:o(()=>[u(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),t(M,{resizable:"","highlight-current-row":"",ref:"xTable","row-id":"id",height:"500px",data:e.tempLists},{default:o(()=>[t(i,{field:"tempTitle",title:"\u6807\u9898"}),t(i,{field:"tempContent",title:"\u5185\u5BB9"},{default:o(({row:n})=>[t(m,{"line-clamp":1,style:{"max-width":"100%"}},{default:o(()=>[u(se(n.tempContent),1)]),_:2},1024)]),_:1}),t(i,{field:"",title:"\u64CD\u4F5C"},{default:o(({row:n})=>[t(b,{type:"text",onClick:()=>{e.formData={...n},e.actionModal=!0},status:"info"},{default:o(()=>[u("\u7F16\u8F91")]),_:2},1032,["onClick"]),t(b,{type:"text",onClick:N=>e.del(n.id),status:"danger"},{default:o(()=>[u("\u5220\u9664 ")]),_:2},1032,["onClick"]),t(b,{type:"text",onClick:N=>e.currentChangeEvent(n),status:"primary"},{default:o(()=>[u("\u9009\u62E9 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(w,{show:e.actionModal,"onUpdate:show":l[8]||(l[8]=n=>e.actionModal=n),preset:"dialog",title:"\u6A21\u677F\u7BA1\u7406"},{action:o(()=>[t(p,{type:"default",size:"small",onClick:l[7]||(l[7]=n=>e.actionModal=!1)},{default:o(()=>[u("\u53D6\u6D88")]),_:1}),t(p,{type:"error",size:"small",style:{"margin-right":"5px"},onClick:e.formBtn},{default:o(()=>[u("\u4FDD\u5B58")]),_:1},8,["onClick"])]),default:o(()=>[t(c,{style:{padding:"0 10px"}},{default:o(()=>[t(g,{label:"\u6807\u9898"},{default:o(()=>[t(d,{value:e.formData.tempTitle,"onUpdate:value":l[5]||(l[5]=n=>e.formData.tempTitle=n),placeholder:""},null,8,["value"])]),_:1}),t(g,{label:"\u5185\u5BB9"},{default:o(()=>[t(d,{value:e.formData.tempContent,"onUpdate:value":l[6]||(l[6]=n=>e.formData.tempContent=n),type:"textarea",placeholder:""},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["show"])]),_:1},8,["show"])}const ve=L(fe,[["render",ge]]),he=P({components:{NModal:D,NInput:U,NForm:$,NFormItem:S,NGrid:F,NGridItem:I,NTreeSelect:z,NSelect:A,NButton:B,NSpin:E,NTag:O,NImage:me,NText:pe,NP:ue,NwDic:Q,NwIcon:W,NwIconPick:X,EmployeePickModal:Y,ChooseDept:Z,NCheckboxGroup:ee,NCheckbox:te,TemplateAction:ve},props:{},setup(e,l){const v=r(!1),h=r({}),_=r(),y=r(!1),p=r([]),f=r(),d=oe(),g=(i={})=>{v.value=!0,h.value={...i}},c=r({receiverUserNames:{required:!0,message:"\u8BF7\u9009\u62E9\u63A5\u6536\u4EBA",trigger:["blur","input"]},receiverDeptNames:{required:!0,message:"\u8BF7\u9009\u62E9\u63A5\u6536\u90E8\u95E8",trigger:["blur","input"]},smsMsgType:{required:!0,message:"\u8BF7\u9009\u62E9\u63D0\u9192\u65B9\u5F0F",trigger:["blur","input"],type:"array"},msgTitle:{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898",trigger:["blur","input"]},msgContent:{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9",trigger:["blur","input"]}});return ie(()=>{}),T(()=>h.value.receiverUserNames,i=>{i&&(c.value.receiverDeptNames.required=!1,_.value.validate())}),T(()=>h.value.receiverDeptNames,i=>{i&&(c.value.receiverUserNames.required=!1,_.value.validate())}),{showModal:v,message:d,templateAction:f,model:h,formRef:_,isLoading:y,sonFn:g,platformDictCodes:p,rules:c,onPositiveClick(){_.value.validate(i=>{if(!i){y.value=!0;let m=le.exports.cloneDeep(h.value);m.smsMsgType=m.smsMsgType?m.smsMsgType.join(","):"",ne(m).then(b=>{b&&(l.emit("update:callback"),v.value=!1)}).finally(b=>{y.value=!1})}})},onNegativeClick(){v.value=!1}}},methods:{}}),_e=k("span",{style:{color:"#1060c9","font-weight":"bolder"}},"\u77ED\u4FE1",-1),ye=k("span",{style:{color:"#1060c9","font-weight":"bolder"}},"\u4F01\u4E1A\u5FAE\u4FE1",-1),be=k("span",{style:{color:"#1060c9","font-weight":"bolder"}},"\u90AE\u7BB1",-1),Ne=k("span",null,"\u5185\u5BB9",-1),Ce={style:{padding:"0 5px 5px 0"}};function ke(e,l,v,h,_,y){const p=a("EmployeePickModal"),f=a("n-form-item"),d=a("n-grid-item"),g=a("ChooseDept"),c=a("n-checkbox"),i=a("n-checkbox-group"),m=a("n-input"),b=a("nw-icon"),M=a("n-grid"),w=a("n-form"),n=a("n-spin"),N=a("n-button"),j=a("n-modal"),R=a("TemplateAction");return q(),re(de,null,[t(j,{show:e.showModal,"onUpdate:show":l[7]||(l[7]=s=>e.showModal=s),"mask-closable":!1,preset:"dialog",title:"\u7FA4\u53D1\u6D88\u606F",content:"\u4F60\u786E\u8BA4","positive-text":"\u786E\u8BA4","negative-text":"\u53D6\u6D88",style:{width:"800px"},ref:"xmodal"},{action:o(()=>[k("div",Ce,[t(N,{size:"small",type:"default",style:{"margin-right":"5px"},onClick:l[6]||(l[6]=s=>e.showModal=!1)},{default:o(()=>[u("\u53D6\u6D88")]),_:1}),t(N,{size:"small",type:"error",onClick:e.onPositiveClick,disabled:e.btloading},{default:o(()=>[u("\u4FDD\u5B58")]),_:1},8,["onClick","disabled"])])]),default:o(()=>[t(n,{show:e.isLoading},{default:o(()=>[t(w,{model:e.model,ref:"formRef",style:{padding:"0 10px"},rules:e.rules},{default:o(()=>[t(M,{"x-gap":"8",cols:1},{default:o(()=>[t(d,null,{default:o(()=>[t(f,{label:"\u63A5\u6536\u4EBA",path:"receiverUserNames"},{default:o(()=>[t(p,{showSide:!0,multiple:!0,isShowSearch:!0,userName:e.model.receiverUserNames,value:e.model.receiverUserIds,"onUpdate:callback":l[0]||(l[0]=s=>{e.model.receiverUserNames=s.map(C=>C.userNameCh).join(","),e.model.receiverUserIds=s.map(C=>C.id).join(",")})},null,8,["userName","value"])]),_:1})]),_:1}),t(d,null,{default:o(()=>[t(f,{label:"\u63A5\u6536\u90E8\u95E8",path:"receiverDeptNames"},{default:o(()=>[t(g,{isShowSearch:!0,orgUserName:e.model.receiverDeptNames,value:e.model.receiverDeptIds,"onUpdate:callback":l[1]||(l[1]=s=>{e.model.receiverDeptIds=s.map(C=>C.id).join(","),e.model.receiverDeptNames=s.map(C=>C.orgName).join(",")})},null,8,["orgUserName","value"])]),_:1})]),_:1}),t(d,null,{default:o(()=>[t(f,{label:"\u63D0\u9192\u65B9\u5F0F",path:"smsMsgType"},{default:o(()=>[t(i,{value:e.model.smsMsgType,"onUpdate:value":l[2]||(l[2]=s=>e.model.smsMsgType=s),name:"checkgroup"},{default:o(()=>[t(c,{value:"sms"},{default:o(()=>[_e]),_:1}),t(c,{value:"qywechat"},{default:o(()=>[ye]),_:1}),t(c,{value:"mail"},{default:o(()=>[be]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(d,null,{default:o(()=>[t(f,{label:"\u6807\u9898",path:"msgTitle"},{default:o(()=>[t(m,{value:e.model.msgTitle,"onUpdate:value":l[3]||(l[3]=s=>e.model.msgTitle=s),placeholder:""},null,8,["value"])]),_:1})]),_:1}),t(d,null,{default:o(()=>[t(f,{label:"\u5185\u5BB9",path:"msgContent"},{label:o(()=>[Ne,t(b,{style:{"margin-left":"5px",height:"20px"},name:"icon-n-y-add",size:14,onClick:l[4]||(l[4]=s=>e.$refs.templateAction.sonFn())})]),default:o(()=>[t(m,{value:e.model.msgContent,"onUpdate:value":l[5]||(l[5]=s=>e.model.msgContent=s),path:"msgContent",type:"textarea","show-count":"",maxlength:(e.model.smsMsgType?e.model.smsMsgType:[]).join(",").includes("sms")?"250":"9999",placeholder:""},null,8,["value","maxlength"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show"])]),_:1},8,["show"]),t(R,{ref:"templateAction","onUpdate:callback":l[8]||(l[8]=s=>{e.model.msgContent=s.tempContent})},null,512)],64)}const $e=L(he,[["render",ke]]);export{$e as M};
