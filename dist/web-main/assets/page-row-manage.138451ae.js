import{r,k as C,a as l,o as T,c as D,K as fe,d as ve,u as _e,j as pe,w as n,h as R,b as t,f as k,p as xe,g as G,F as ce,t as Ce,e as L,U as Le,_ as Be,$ as $e}from"./runtime-dom.esm-bundler.bf4f36cb.js";import{aq as W,ar as J,aA as ae,as as X,aZ as ne,aw as ge,e as Y,am as Z,ak as le,f as $,i as P,aK as ke,_ as V,r as M,a as se,b as re,c as ie,d as ue,al as ze,k as he,an as ye,j as Ve,ao as He,u as Ie,a$ as Re,N as Te,aY as qe,b0 as Me,aJ as je,az as Ae,ap as Ge,at as Se,au as Ke,av as Qe,ax as We,ay as Je,aI as Xe,d$ as Ye,aB as Ze,m as et}from"./index.0e7eb3bd.js";import{N as tt}from"./Image.316697df.js";import{N as ot}from"./text.c79655f7.js";import{N as at}from"./p.0c502c64.js";import{q as nt}from"./index.946bf9a2.js";import{m as lt}from"./max.09297b96.js";import{h as st}from"./index.9cc9edd5.js";import{N as rt}from"./InputNumber.39ec7792.js";import{N as it}from"./Radio.929283f6.js";import{N as ut}from"./FormItemGridItem.5c201774.js";import{N as dt,a as pt}from"./Step.db780097.js";import{N as ct}from"./Transfer.0159dc42.js";import{N as mt,a as ft}from"./Tabs.dac43389.js";import{N as vt}from"./Scrollbar.e2b8029c.js";import{N as Ne}from"./Dropdown.c5536ab3.js";import"./Add.f7b12907.js";const _t={components:{NLayout:W,NLayoutHeader:J,NLayoutSider:ae,NLayoutContent:X,NLayoutFooter:ne,NInputGroup:ge,NInput:Y,NSpin:Z,NModal:le,NButton:$,NwIcon:P,NSwitch:ke},props:{multiple:{type:Boolean,default:!1},value:{type:String,default:""}},emits:["callback"],setup(e,a){const h=r(null),o=r(!0),g=r({rowId:"id",rowKey:!1,size:"mini",height:"500px",showOverflow:!1,highlightHoverRow:!0,showHeader:!1,border:"null",rowConfig:{isCurrent:!0,height:43},proxyConfig:{seq:!1,ajax:{query:()=>new Promise(d=>{nt({}).then(s=>{d(s)})})}},columns:[{field:"name",title:"\u4E1A\u52A1\u5165\u53E3\u540D\u79F0",showHeaderOverflow:!0,showOverflow:!0,slots:{default:({row:d})=>[C("div",{class:{"side-tree-btn":!0},title:d.name,onClick:()=>{a.emit("callback",d)}},C(P,{name:d.orgType==1?"icon-n-y-fenjifenlei":"icon-n-y-fenlei"}),C("span",{style:"margin-left:5px"},d.name))]}}]});return{props:e,gridRef:h,isLoading:o,gridOption:g}}};function gt(e,a,h,o,g,d){const s=l("vxe-grid");return T(),D(s,fe(o.gridOption,{ref:"gridComponent",class:"mytable-scrollbar org-tree"}),null,16)}const ht=V(_t,[["render",gt]]);function yt(e){return M({url:"/main/mdmRole/list",method:"post",data:e})}function bt(e){return M({url:"/main/mdmRole",method:"post",data:e})}function wt(e){return M({url:"/main/mdmRole",method:"put",data:e})}function St(e){return M({url:`/main/mdmRole/${e}`,method:"delete"})}function Nt(e){return M({url:"/main/mdmSys/lists",method:"post",data:e})}function xt(e){return M({url:`/main/mdmRoleResource/getByRoleId?roleId=${e.id}`,method:"get"})}function Ct(e){return M({url:"/main/mdmMenu/treeList",method:"post",data:e})}function kt(e){return M({url:"/main/mdmRoleResource",method:"post",data:e})}function zt(e){return M({url:"/main/mdmOrg/list",method:"post",data:e})}function It(e){return M({url:"/main/mdmUser/lists",method:"post",data:e})}function Rt(e){return M({url:"/main/mdmPost/lists",method:"post",data:e})}function Tt(e){return M({url:"/main/mdmRole/setRolePostUserRel",method:"post",data:e})}function Mt(e){return M({url:`/main/mdmRole/getRolePostUserRel?roleId=${e.id}`,method:"get"})}const At=ve({components:{NModal:le,NInput:Y,NForm:se,NFormItem:re,NGrid:ie,NGridItem:ue,NTreeSelect:ze,NSelect:he,NButton:$,NSpin:Z,NTag:ye,NImage:tt,NText:ot,NP:at,NwDic:Ve,NwIcon:P,NwIconPick:He},props:{},setup(e,a){const h=r(!1),o=r({}),g=r(),d=r(!1),s=Ie(),i=(u={})=>{console.log(u,"aaaaaaaaaaaaaaaa"),h.value=!0,o.value={...u}};return _e(()=>{}),{showModal:h,message:s,model:o,formRef:g,mdmSysLists:Nt,isLoading:d,sonFn:i,status:pe([{label:"\u5426",value:0},{label:"\u662F",value:1}]),roleTypes:pe([{label:"\u529F\u80FD\u89D2\u8272",value:1},{label:"\u6570\u636E\u89D2\u8272",value:2},{label:"\u6D41\u7A0B\u89D2\u8272",value:3}]),onPositiveClick(){const u=o.value.id?wt:bt;g.value.validate(v=>{v||(d.value=!0,u(o.value).then(p=>{p&&(a.emit("update:callback"),h.value=!1)}).finally(p=>{d.value=!1}))})},onNegativeClick(){h.value=!1}}},methods:{}}),Ft={style:{padding:"0 5px 5px 0"}};function Et(e,a,h,o,g,d){const s=l("n-input"),i=l("n-form-item"),u=l("n-grid-item"),v=l("n-select"),p=l("n-grid"),y=l("n-form"),b=l("n-spin"),N=l("n-button"),x=l("n-modal");return T(),D(x,{show:e.showModal,"onUpdate:show":a[6]||(a[6]=m=>e.showModal=m),"mask-closable":!1,preset:"dialog",title:"\u89D2\u8272\u7BA1\u7406",content:"\u4F60\u786E\u8BA4","positive-text":"\u786E\u8BA4","negative-text":"\u53D6\u6D88",style:{width:"800px"},ref:"xmodal"},{action:n(()=>[R("div",Ft,[t(N,{size:"small",type:"default",style:{"margin-right":"5px"},onClick:a[5]||(a[5]=m=>e.showModal=!1)},{default:n(()=>[k("\u53D6\u6D88")]),_:1}),t(N,{size:"small",type:"info",onClick:e.onPositiveClick,disabled:e.btloading},{default:n(()=>[k("\u4FDD\u5B58")]),_:1},8,["onClick","disabled"])])]),default:n(()=>[t(b,{show:e.isLoading},{default:n(()=>[t(y,{model:e.model,ref:"formRef",rules:e.rules},{default:n(()=>[t(p,{"x-gap":"8",cols:1},{default:n(()=>[t(u,null,{default:n(()=>[t(i,{label:"\u6240\u5C5E\u5E94\u7528",path:"appName"},{default:n(()=>[t(s,{placeholder:"",disabled:"",value:e.model.appName,"onUpdate:value":a[0]||(a[0]=m=>e.model.appName=m)},null,8,["value"])]),_:1})]),_:1}),t(u,null,{default:n(()=>[t(i,{label:"\u89D2\u8272\u540D\u79F0",path:"roleName"},{default:n(()=>[t(s,{placeholder:"\u8BF7\u8F93\u5165",value:e.model.roleName,"onUpdate:value":a[1]||(a[1]=m=>e.model.roleName=m)},null,8,["value"])]),_:1})]),_:1}),t(u,null,{default:n(()=>[t(i,{label:"\u89D2\u8272\u7F16\u7801",path:"roleCode"},{default:n(()=>[t(s,{placeholder:"\u8BF7\u8F93\u5165",value:e.model.roleCode,"onUpdate:value":a[2]||(a[2]=m=>e.model.roleCode=m)},null,8,["value"])]),_:1})]),_:1}),t(u,null,{default:n(()=>[t(i,{label:"\u89D2\u8272\u7C7B\u578B",path:"roleType"},{default:n(()=>[t(v,{value:e.model.roleType,"onUpdate:value":a[3]||(a[3]=m=>e.model.roleType=m),placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272\u7C7B\u578B",options:e.roleTypes},null,8,["value","options"])]),_:1})]),_:1}),t(u,null,{default:n(()=>[t(i,{label:"\u662F\u5426\u542F\u7528",path:"status"},{default:n(()=>[t(v,{value:e.model.status,"onUpdate:value":a[4]||(a[4]=m=>e.model.status=m),placeholder:"\u8BF7\u9009\u62E9\u680F\u76EE\u7C7B\u578B",options:e.status},null,8,["value","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show"])]),_:1},8,["show"])}const Pt=V(At,[["render",Et]]),Dt={common:{borderRadius:"0px"},Tag:{heightSmall:"14px"},Tabs:{tabFontSizeSmall:"14px",tabPaddingSmallCard:"2px 6px 0px 6px",tabBorderColor:"#a9a9a9",panePaddingSmall:"0"},Input:{fontSizeSmall:"12px",heightSmall:"24px",textColorDisabled:"#4d4d4d"},Form:{labelFontSizeTopSmall:"12px",labelPaddingVertical:"0 0 4px 2px",labelHeightSmall:"24px",blankHeightSmall:"24px",labelFontSizeLeftSmall:"12px",feedbackHeightSmall:"16px",feedbackFontSizeSmall:"12px"},Button:{heightSmall:"24px",fontSizeSmall:"12px",iconSizeSmall:"14px",iconMarginSmall:"2px"},Dialog:{iconMargin:"0 3px 0 0",titleFontSize:"14px",titleFontWeight:"bold",titleTextColor:"#5e5e5e",iconSize:"14px",padding:"2px 5px",closeSize:"14px",closeMargin:"5px",contentMargin:"0"},Modal:{boxShadow:"1px 0px 7px 1px #00000060"},Select:{peers:{InternalSelection:{heightSmall:"24px",fontSizeSmall:"12px",menuBoxShadow:"1px 0px 7px 1px #000"},InternalSelectMenu:{optionFontSizeSmall:"12px",optionHeightSmall:"14px",peers:{}},Empty:{fontSizeSmall:"12px",iconSizeSmall:"20px"}}},Slider:{fontSize:"12px",dotWidth:"8px",dotHeight:"8px",handleSize:"10px"}},K=r(!1);r(!0);r(!1);const Ut=r(!1),Fe=r([]),j=r("loading"),be=r(!1),te=r([]),we=r(),Q=r(null);r([]);r([]);const U=r(null),Ee=r(""),Ot=e=>{U.value.descendants().forEach(a=>{U.value!==a&&(a.isEmpower=e)})},Lt=()=>{Q.value=null,te.value=[],E.value=[],we.value=[],j.value="loading",U.value=null,K.value=!1,B.value=[]},E=r([]),Bt=async e=>{Lt(),Q.value=e,be.value=!0,Ut.value=!0,await xt({id:Q.value.id}).then(a=>E.value=a)},me=r(null),B=r([]),oe=r([]),Pe=e=>{B.value=[],U.value=e;const a=[];U.value.leaves().forEach((o,g)=>{const s=o.ancestors().splice(0,o.ancestors().indexOf(U.value)).map(i=>{let u=0;return i.data._span||(u=i.data._span=i.leaves().length),{id:i.data.id,icon:i.data.icon,menuType:i.data.menuType,bizMenuCode:i.data.bizMenuCode,menuName:i.data.menuName,children:i.data.kids,spanCell:{},Node:i,span:u}}).reverse();a.push(s)}),B.value=a,console.log(B.value,"-=-=-=-=");const h=lt(a,o=>o.length);oe.value=[];for(let o=0;o<h;o++)Fe.value.push(`name${o}`),oe.value.push({slots:{default:({row:g})=>{if(g[o]){let d="";switch(g[o].menuType){case 0:d="icon-y-caidan";break;case 1:d="icon-y-xinyemian";break;case 2:d="icon-y-anniu";break;case"3":d="icon-y-liucheng";break;default:d="icon-bangzhu";break}const s=g[o].Node,i=s.descendants().filter(u=>u!==s);return C("div",{style:"display: flex;align-items: center;"},C(P,{size:18,name:d,style:"margin-right: 5px;"}),C(Re,{indeterminate:i.some(u=>u.isEmpower)&&i.some(u=>!u.isEmpower),checked:!!s.isEmpower,onUpdateChecked:u=>{s.isEmpower=u,E.value.filter(p=>p.bizMenuCode==s.data.bizMenuCode)[0]||E.value.push({bizMenuCode:s.data.bizMenuCode,resourceId:[]});let v=E.value.filter(p=>p.bizMenuCode==s.data.bizMenuCode)[0];v&&u&&v.resourceId.push(s.data.id),u?(s.ancestors().forEach(p=>{p.isEmpower=!0,p.data.id!="0"&&(v.resourceId.push(p.data.id),v.resourceId=Array.from(new Set(v.resourceId)))}),s.descendants().forEach(p=>{p.isEmpower=!0,p.data.id!==0&&(v.resourceId.push(p.data.id),v.resourceId=Array.from(new Set(v.resourceId)))})):s.descendants().forEach(p=>{p.isEmpower=!1,v.resourceId.forEach((y,b,N)=>{y==p.data.id&&N.splice(b,1)})})},style:"margin-right: 5px;"}),g[o].menuName)}return""}}});xe().then(()=>{E.value.filter(o=>o.bizMenuCode==Ee.value)[0].resourceId,me.value.reloadColumn(oe.value),me.value.loadData(B.value)})},$t=()=>{we.value.map(e=>(e.resourceId.descendants().forEach(a=>{a.data.id!=="0"&&(a.isEmpower||a.descendants().forEach(h=>{h.isEmpower=!1}))}),e)),K.value=!0,j.value="loading",kt({roleCode:Q.value.roleCode,roleId:Q.value.id,resourceIds:E.value}).then(e=>{j.value="complete",be.value=!1}).catch(e=>{j.value="fail",console.error(e)})},Vt=e=>{K.value=!0,Ee.value=e.code,Ct({bizMenuCode:e.code,includeSth:"0"}).then(a=>{if(a.length){const h=E.value.filter(o=>o.bizMenuCode==e.code)[0]?E.value.filter(o=>o.bizMenuCode==e.code)[0].resourceId:[];te.value=st({kids:a,id:"0"},o=>o.kids),te.value.each((o,g)=>{h.includes(o.data.id)&&(o.isEmpower=!0)}),Pe(te.value)}}),K.value=!1},Ht=ve({components:{NLayout:W,NLayoutHeader:J,NLayoutSider:ae,NLayoutContent:X,NLayoutFooter:ne,NwIcon:P,NButton:$},setup(){const e=({rowIndex:h,columnIndex:o,visibleData:g})=>{const d=g[h][o];return d?{rowspan:d.span,colspan:1}:{rowspan:1,colspan:1}},a=r({rowId:"id",rowKey:!1,size:"mini",showOverflow:!1,highlightHoverRow:!0,border:!0,showHeader:!1,resizable:!0,spanMethod:e,tableMenu:{},data:B,columns:oe});return{CurrentSys:U,TreeTableRef:me,spanMethod:e,gridOption:a,fields:Fe,setAllRoleToCurrentSys:Ot}}});const qt={class:"step3-header"},jt={class:"step3-header-title"},Gt={class:"step3-header-legend"},Kt={class:"legend-item"},Qt={class:"legend-item"},Wt={class:"legend-item"},Jt={class:"legend-item"};function Xt(e,a,h,o,g,d){const s=l("nw-icon"),i=l("n-button"),u=l("n-layout-header"),v=l("vxe-grid"),p=l("n-layout-content"),y=l("n-layout");return T(),D(y,{style:{height:"100%"}},{default:n(()=>[t(u,null,{default:n(()=>[R("div",qt,[R("div",jt,[e.CurrentSys?(T(),G(ce,{key:0},[t(s,{size:24,name:e.CurrentSys.data.icon,style:{"margin-right":"3px"}},null,8,["name"]),k(" "+Ce(e.CurrentSys?e.CurrentSys.data.menuName:"")+" ",1),t(i,{size:"small",type:"primary",style:{"margin-left":"5px"},onClick:a[0]||(a[0]=b=>e.setAllRoleToCurrentSys(!0))},{default:n(()=>[k("\u5168\u9009")]),_:1}),t(i,{size:"small",type:"warning",style:{"margin-left":"5px"},onClick:a[1]||(a[1]=b=>e.setAllRoleToCurrentSys(!1))},{default:n(()=>[k("\u6E05\u7A7A")]),_:1})],64)):L("",!0)]),R("div",Gt,[R("div",Kt,[t(s,{name:"icon-y-caidan",size:18}),k(" \u83DC\u5355 ")]),R("div",Qt,[t(s,{size:18,name:"icon-y-xinyemian",style:{"margin-right":"5px"}}),k(" \u9875\u9762 ")]),R("div",Wt,[t(s,{size:18,name:"icon-y-anniu",style:{"margin-right":"5px"}}),k(" \u666E\u901A\u6309\u94AE ")]),R("div",Jt,[t(s,{size:18,name:"icon-y-liucheng",style:{"margin-right":"5px"}}),k(" \u6D41\u7A0B\u6309\u94AE ")])])])]),_:1}),t(p,{"native-scrollbar":!1,style:{height:"calc(100% - 34px)"}},{default:n(()=>[t(v,fe({class:"nw-vxe-grid",ref:b=>e.TreeTableRef=b},e.gridOption),{top:n(()=>[]),_:1},16)]),_:1})]),_:1})}const Yt=V(Ht,[["render",Xt],["__scopeId","data-v-f40e82f8"]]),Zt={components:{NSpace:Te,NConfigProvider:qe,NLayout:W,NLayoutHeader:J,NLayoutSider:ae,NLayoutContent:X,NLayoutFooter:ne,NInputGroup:ge,NInput:Y,NInputNumber:rt,NSelect:he,NRadio:it,NRadioGroup:Me,NSwitch:ke,NSpin:Z,NModal:le,NButton:$,NwIcon:P,NGrid:ie,NGi:ue,NForm:se,NFormItemGi:ut,NFormItem:re,NSteps:dt,NStep:pt,NDivider:je,NTag:ye,Step3:Yt,BizMenu:ht},props:{},emits:["callback"],setup(e,a){return{visible:be,theme:Dt,spinIsLoading:K,spinState:j,show:Bt,TreeMenuRoot:we,setSysTabelData:Pe,CurrentSys:U,submitRole:$t,getSourceList:Vt}}};const eo=R("div",null," \u6743\u9650\u5206\u914D ",-1),to={key:0,style:{background:"#fff","font-size":"14px","font-weight":"bold"}},oo={key:1,style:{background:"#fff","font-size":"14px","font-weight":"bold"}},ao={class:"step-body",style:{height:"100%",padding:"0"}},no={class:"step-pane",style:{height:"100%",padding:"0"}},lo={class:"nw-modal-action"};function so(e,a,h,o,g,d){const s=l("nw-icon"),i=l("BizMenu"),u=l("n-layout-sider"),v=l("step3"),p=l("n-layout-content"),y=l("n-layout"),b=l("n-button"),N=l("n-spin"),x=l("n-modal"),m=l("n-config-provider");return T(),D(m,{abstract:"","theme-overrides":o.theme},{default:n(()=>[t(x,{class:"nw-modal",show:o.visible,"onUpdate:show":a[1]||(a[1]=A=>o.visible=A),preset:"dialog",style:{width:"1000px",padding:"0"},"show-icon":!0,"mask-closable":!0,closable:!0},{icon:n(()=>[t(s,{name:"icon-biaodan",size:20,color:"rgb(103, 194, 58)"})]),header:n(()=>[eo]),default:n(()=>[t(N,{show:o.spinIsLoading,rotate:o.spinState==="loading"},{icon:n(()=>[o.spinState==="loading"?(T(),D(s,{key:0,name:"icon-loading",size:34,color:"rgb(103, 194, 58)"})):L("",!0),o.spinState==="complete"?(T(),D(s,{key:1,name:"icon-duigou",size:44,color:"rgb(103, 194, 58)"})):L("",!0),o.spinState==="fail"?(T(),D(s,{key:2,name:"icon-cuowu",size:44,color:"#f44336"})):L("",!0)]),description:n(()=>[o.spinState==="complete"?(T(),G("div",to," \u6743\u9650\u5206\u914D\u6210\u529F ")):L("",!0),o.spinState==="fail"?(T(),G("div",oo," \u6743\u9650\u5206\u914D\u5931\u8D25 ")):L("",!0)]),default:n(()=>[t(y,null,{default:n(()=>[t(p,{style:{height:"500px"}},{default:n(()=>[R("div",ao,[R("div",no,[t(y,{class:"step3-layout","has-sider":"",style:{height:"100%"}},{default:n(()=>[t(u,{bordered:"","native-scrollbar":!1,width:"280"},{default:n(()=>[t(i,{onCallback:o.getSourceList},null,8,["onCallback"])]),_:1}),t(p,{style:{height:"100%"}},{default:n(()=>[t(v)]),_:1})]),_:1})])])]),_:1})]),_:1}),R("div",lo,[t(b,{type:"info",size:"small",style:{"margin-right":"5px"},onClick:o.submitRole},{default:n(()=>[k("\u63D0\u4EA4")]),_:1},8,["onClick"]),t(b,{size:"small",onClick:a[0]||(a[0]=A=>o.visible=!1)},{default:n(()=>[k("\u53D6\u6D88")]),_:1})])]),_:1},8,["show","rotate"])]),_:1},8,["show"])]),_:1},8,["theme-overrides"])}const ro=V(Zt,[["render",so]]),io={components:{NModal:le,NInput:Y,NForm:se,NFormItem:re,NGrid:ie,NGridItem:ue,NTreeSelect:ze,NSelect:he,NLayout:W,NLayoutHeader:J,NLayoutContent:X,NLayoutFooter:ne,NTabs:mt,NTabPane:ft,NCheckbox:Re,NSpin:Z,NTree:Ae,NTransfer:ct,NwIcon:P,NButton:$,NScrollbar:vt},props:{model:{default:{},type:Object}},setup(e,a){const h=r(""),o=r([]),g=r(!1),d=r(!1),s=r(!1),i=r([]),u=r([]),v=r([]),p=r([]),y=r(""),b=r("\u4EBA\u5458"),N=r({}),x=r(new Map),m=r(new Map),A=({option:c})=>C(P,{name:c.orgType==1?"icon-n-y-fenjifenlei":"icon-n-y-app"}),z=({option:c})=>C("div",null,C("span",{style:`color:${m.value.get(c.id)?"#2080f0":""}`}," ",m.value.get(c.id)?m.value.get(c.id).length:0," \u4EBA"),C("span",{style:`color:${x.value.get(c.id)?"#2080f0":""}`}," ",x.value.get(c.id)?x.value.get(c.id).length:0," \u5C97")),H=c=>{N.value={...c},d.value=!0,g.value=!0,zt({isDefault:0,status:1}).then(S=>{o.value=S,g.value=!1}),Mt({id:c.id}).then(S=>{S.roleUsers.map(w=>(w.orgId=w.createUserParentOrgId,w)),S.rolePosts.map(w=>(w.orgId=w.createUserParentOrgId,w));const _=Array.from(new Set(S.roleUsers.map(w=>w.orgId))),q=Array.from(new Set(S.rolePosts.map(w=>w.orgId)));_.map(w=>{m.value.set(w,S.roleUsers.filter(O=>O.orgId==w).map(O=>O.userId))}),q.map(w=>{x.value.set(w,S.roleUsers.filter(O=>O.orgId==w).map(O=>O.postId))}),console.log(m.value," allEmpV.value")})},f=c=>{c.length>0&&(s.value=!0,i.value=[],v.value=[],p.value=[],y.value=c[0],It({parentOrgId:c[0]}).then(S=>{i.value=S.map(_=>(_.label=_.userNameCh,_.value=_.id,_.key=_.id,_)),v.value=m.value.get(c[0]),b.value=="\u4EBA\u5458"&&(s.value=!1)}),Rt({parentOrgId:c[0]}).then(S=>{u.value=S.map(_=>(_.label=_.postName,_.value=_.id,_.key=_.id,_)),p.value=x.value.get(c[0]),b.value=="\u5C97\u4F4D"&&(s.value=!1)}))},I=()=>{s.value=!1;var c=[];let S=[];m.value.forEach(_=>{c=[...c,...Object.values(_)]}),x.value.forEach(_=>{S=[...S,...Object.values(_)]}),Tt({roleCode:N.value.roleCode,roleId:N.value.id,roleName:N.value.roleName,userIds:c.join(","),postIds:S.join(",")}).then(_=>{d.value=!1,s.value=!1,x.value.clear(),b.value="\u4EBA\u5458",m.value.clear()}).finally(_=>{s.value=!1})},ee=c=>{m.value.set(y.value,c),console.log(m.value," allEmpV.value")},de=c=>{x.value.set(y.value,c)},F=(c,S)=>(c.push(...S),Array.from(new Set(c))),De=(c,S)=>{let _=[];for(let q=0;q<S.length;q++)for(let w=0;w<c.length;w++)c[w]===S[q]&&_.push(c[w]);return _},Ue=c=>{b.value=c},Oe=()=>{d.value=!1};return _e(()=>{}),{renderPrefix:A,renderSuffix:z,pattern:h,treeList:o,data:N,allEmpV:m,allPostV:x,treeShow:g,isLoading:!1,showModal:d,sonFn:H,getPost:f,onPositiveClick:I,empChange:ee,tabChange:Ue,postChange:de,uniqueArr:F,getSome:De,onNegativeClick:Oe,empOptions:i,postOptions:u,empV:v,tabV:b,postV:p,orgId:y}}};const uo={style:{padding:"0 5px 5px 0"}};function po(e,a,h,o,g,d){const s=l("n-input"),i=l("n-tree"),u=l("n-spin"),v=l("n-scrollbar"),p=l("n-grid-item"),y=l("n-transfer"),b=l("n-tab-pane"),N=l("n-tabs"),x=l("n-grid"),m=l("n-button"),A=l("n-modal");return T(),D(A,{show:o.showModal,"onUpdate:show":a[4]||(a[4]=z=>o.showModal=z),"mask-closable":!1,preset:"dialog",title:"\u7EC4\u7EC7\u5173\u8054",content:"\u4F60\u786E\u8BA4","positive-text":"\u786E\u8BA4","negative-text":"\u53D6\u6D88",style:{width:"1400px"}},{action:n(()=>[R("div",uo,[t(m,{size:"small",type:"default",style:{"margin-right":"5px"},onClick:a[3]||(a[3]=z=>o.showModal=!1)},{default:n(()=>[k("\u53D6\u6D88")]),_:1}),t(m,{size:"small",type:"info",onClick:o.onPositiveClick},{default:n(()=>[k("\u4FDD\u5B58")]),_:1},8,["onClick"])])]),default:n(()=>[t(u,{show:o.isLoading},{default:n(()=>[t(x,null,{default:n(()=>[t(p,{span:"8",style:{height:"800px","border-right":"1px solid #dcdee2"}},{default:n(()=>[t(s,{value:o.pattern,"onUpdate:value":a[0]||(a[0]=z=>o.pattern=z),placeholder:"\u641C\u7D22"},null,8,["value"]),t(v,{"x-scrollable":"",style:{height:"800px"}},{default:n(()=>[t(u,{show:o.treeShow},{default:n(()=>[t(i,{size:"small",placeholder:"\u8BF7\u9009\u62E9",data:o.treeList,style:{padding:"5px 0"},"block-line":"","label-field":"orgName","key-field":"id","children-field":"kids",pattern:o.pattern,"default-expanded-keys":["0"],"render-prefix":o.renderPrefix,"render-suffix":o.renderSuffix,"onUpdate:selectedKeys":o.getPost},null,8,["data","pattern","render-prefix","render-suffix","onUpdate:selectedKeys"])]),_:1},8,["show"])]),_:1})]),_:1}),t(p,{span:16,style:{height:"800px"}},{default:n(()=>[t(N,{type:"line","tabs-padding":10,"pane-style":"padding:0px;",class:"nTabA","default-value":o.tabV,"onUpdate:value":o.tabChange},{default:n(()=>[t(b,{name:"\u4EBA\u5458"},{default:n(()=>[t(y,{"virtual-scroll":"",ref:"transfer",value:o.empV,"onUpdate:value":[a[1]||(a[1]=z=>o.empV=z),o.empChange],options:o.empOptions,filterable:"",style:{width:"80%",height:"700px",padding:"10px 0",margin:"auto"}},null,8,["value","options","onUpdate:value"])]),_:1}),t(b,{name:"\u5C97\u4F4D"},{default:n(()=>[t(y,{"virtual-scroll":"",ref:"transfer",value:o.postV,"onUpdate:value":[a[2]||(a[2]=z=>o.postV=z),o.postChange],options:o.postOptions,filterable:"",style:{width:"80%",height:"700px",padding:"10px 0",margin:"auto"}},null,8,["value","options","onUpdate:value"])]),_:1})]),_:1},8,["default-value","onUpdate:value"])]),_:1})]),_:1})]),_:1},8,["show"])]),_:1},8,["show"])}const co=V(io,[["render",po],["__scopeId","data-v-8c45d590"]]),mo=ve({components:{NwTable:Ge,NLayout:W,NLayoutHeader:J,NLayoutContent:X,NButton:$,NPopconfirm:Se,NSpace:Te,NwIcon:P,NGrid:ie,NGridItem:ue,NForm:se,NFormItem:re,NPopover:Ke,NCard:Qe,NTag:ye,NSpin:Z,NInput:Y,NInputGroup:ge,NDrawer:We,NDrawerContent:Je,NTree:Ae,NLayoutSider:ae,ModalAction:Pt,SideTree:Xe,NRadioGroup:Me,NRadioButton:Ye,NDropdown:Ne,Associated:co,AssignPermissions:ro},setup(e,a){Ze();const h=r(null),o=r(),g=r({}),d=r(),s=r({}),i=r({}),u=r(!1),v=Ie(),p=r(""),y=r(),b=[{label:"\u4FEE\u6539",key:"modalAction"},{label:"\u6743\u9650\u5206\u914D",key:"AssignPermissionsRef"},{label:"\u7EC4\u7EC7\u5173\u8054",key:"associated"}],N=(f,I)=>{switch(f){case"AssignPermissionsRef":h.value.show(I);break;case"modalAction":y.value.sonFn({...i.value,...I});break;case"associated":o.value.sonFn(I);break}},x=f=>{let I=f.id;St(I).then(ee=>{v.success("\u5220\u9664\u6210\u529F"),d.value.commitQuery()})},m=f=>{i.value=f,z.request.params.appCode=f.appCode,d.value.commitQuery()},A=pe([{field:"roleName",title:"\u89D2\u8272\u540D\u79F0",showHeaderOverflow:!0,slots:{default:({row:f})=>C("span",{style:" white-space: nowrap;overflow: hidden; text-overflow: ellipsis;display:inline-block;width:100%"},f.roleName)}},{title:"\u89D2\u8272\u7F16\u7801",showHeaderOverflow:!0,showOverflow:!0,slots:{default:({row:f})=>C("span",null,f.roleCode)}},{title:"\u89D2\u8272\u7C7B\u578B",field:"roleType",showHeaderOverflow:!0,showOverflow:!0,slots:{default:({row:f})=>[C("span",null,f.roleType==1?"\u529F\u80FD\u89D2\u8272":f.roleType==2?"\u6570\u636E\u89D2\u8272":f.roleType==3?"\u6D41\u7A0B\u89D2\u8272":"")]}},{field:"status",title:"\u542F\u7528\u72B6\u6001",showOverflow:!0,slots:{default:({row:f})=>[C("span",null,f.status==1?"\u542F\u7528":"\u7981\u7528")]}},{field:"",title:"\u64CD\u4F5C",fixed:"right",width:200,showHeaderOverflow:!0,slots:{default:({row:f})=>[C("div",null,C(Se,{"onPositive-click":I=>{x(f)},"positive-text":"\u786E\u5B9A","negative-text":"\u53D6\u6D88"},{trigger:()=>C("a",{style:"color:red;cursor: pointer;display:inline-block;margin-left:8px"},"\u5220\u9664"),default:()=>"\u662F\u5426\u5220\u9664\u5F53\u524D\u9009\u9879?"}),C(Ne,{onSelect:I=>N(I,f),trigger:"hover",showArrow:!0,options:b},C("span",{type:"text",style:`color:#2d8cf0;cursor: pointer;margin-left: 9px;\r
                    font-size: 24px;\r
                    font-weight: bold;`},"...")))]}}]),z={request:{XHR:yt,params:{appCode:"root"},pageMethod:(f,I)=>({page:{current:f,size:I}})},response:{dataMethod:f=>f.records,pageMethod:({total:f})=>f}},H=(f={})=>{y.value.sonFn(f)};return xe().then(()=>{g.value.roleType=""}),_e(()=>{}),{appMessage:i,sideTreeCallback:m,showAction:H,associated:o,handleSelect:N,SearchForm:g,columns:A,tableRef:d,vbind:z,AssignPermissionsRef:h,modalAction:y,model:s,isLoading:u,filterData:p}}});const fo=e=>(Be("data-v-36327348"),e=e(),$e(),e),vo=fo(()=>R("span",null,null,-1));function _o(e,a,h,o,g,d){const s=l("n-space"),i=l("n-radio-button"),u=l("n-radio-group"),v=l("n-form-item"),p=l("n-input"),y=l("n-button"),b=l("n-form"),N=l("nw-icon"),x=l("n-layout-header"),m=l("SideTree"),A=l("n-layout-sider"),z=l("NwTable"),H=l("n-layout-content"),f=l("n-layout"),I=l("ModalAction"),ee=l("AssignPermissions"),de=l("Associated");return T(),G(ce,null,[t(f,{class:"nw-layout-full"},{default:n(()=>[t(x,{class:"nw-layout-header"},{default:n(()=>[t(s,{size:5},{default:n(()=>[vo]),_:1}),t(s,{size:5,style:{padding:"0 5px",position:"absolute",left:"250px"}},{default:n(()=>[t(b,{ref:"formRef",inline:"","label-placement":"left","label-width":80,model:e.SearchForm,style:{height:"30px"}},{default:n(()=>[t(v,{label:"\u89D2\u8272\u7C7B\u578B",path:"roleType"},{default:n(()=>[t(u,{value:e.SearchForm.roleType,"onUpdate:value":[a[0]||(a[0]=F=>e.SearchForm.roleType=F),a[1]||(a[1]=()=>{e.vbind.request.params.roleType=e.SearchForm.roleType,e.$refs.tableRef.commitQuery()})],name:"radiobuttongroup1"},{default:n(()=>[t(s,{size:1},{default:n(()=>[(T(),G(ce,null,Le([{label:"\u5168\u90E8",value:""},{label:"\u529F\u80FD\u89D2\u8272",value:1},{label:"\u6570\u636E\u89D2\u8272",value:2},{label:"\u6D41\u7A0B\u89D2\u8272",value:3}],F=>t(i,{size:"small",key:F.value,value:F.value},{default:n(()=>[k(Ce(F.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["value"])]),_:1}),t(v,{label:"\u89D2\u8272\u540D\u79F0",path:"roleName"},{default:n(()=>[t(p,{value:e.SearchForm.roleName,"onUpdate:value":a[2]||(a[2]=F=>e.SearchForm.roleName=F),placeholder:"\u89D2\u8272\u540D\u79F0"},null,8,["value"])]),_:1}),t(v,null,{default:n(()=>[t(y,{type:"info","attr-type":"button",style:{"margin-right":"5px"},onClick:a[3]||(a[3]=()=>{e.vbind.request.params.roleName=e.SearchForm.roleName,e.$refs.tableRef.commitQuery()})},{default:n(()=>[k(" \u67E5\u8BE2 ")]),_:1}),t(y,{type:"warning","attr-type":"button",onClick:a[4]||(a[4]=()=>{e.SearchForm.roleName="",e.vbind.request.params.roleName="",e.SearchForm.roleType="",e.vbind.request.params.roleType="",e.$refs.tableRef.commitQuery()})},{default:n(()=>[k(" \u91CD\u7F6E ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(s,{size:5,style:{padding:"0 5px"}},{default:n(()=>[t(y,{type:"primary",onClick:a[5]||(a[5]=F=>e.showAction({...e.appMessage})),disabled:!e.appMessage.appId},{icon:n(()=>[t(N,{name:"icon-n-y-add",size:14})]),default:n(()=>[k(" \u65B0\u5EFA ")]),_:1},8,["disabled"])]),_:1})]),_:1}),t(f,{"has-sider":"","content-style":"height: 100%"},{default:n(()=>[t(A,null,{default:n(()=>[t(m,{onCallback:e.sideTreeCallback},null,8,["onCallback"])]),_:1}),t(H,null,{default:n(()=>[t(z,fe({ref:"tableRef",columns:e.columns},e.vbind),null,16,["columns"])]),_:1})]),_:1})]),_:1}),t(I,{ref:"modalAction","onUpdate:callback":a[6]||(a[6]=()=>{e.$refs.tableRef.commitQuery()})},null,512),t(ee,{ref:"AssignPermissionsRef"},null,512),t(de,{ref:"associated"},null,512)],64)}const go=V(mo,[["render",_o],["__scopeId","data-v-36327348"]]);et(go).mount("#app");
