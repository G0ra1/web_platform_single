import{r as L,d as z,N as K,a as M,b as Z,c as j,e as H,f as J,g as Q,h as W,i as E,j as Y,k as ee,l as x,m as V,n as ae,u as F,o as le,_ as U,p as o,q as y,s as b,w as l,t as R,v,x as w,y as a,z as P,A as te,F as S,B as $,D as ne,E as oe,G as re,H as se,I as pe,J as ie,K as ue,L as de,M as me,O as ce,V as fe,P as A,R as ye,Q as ve,S as ge,T as _e}from"./index.b9dd0157.js";import{N as be}from"./index.5b379d15.js";import{a as Te}from"./index.a8f087d3.js";import{N as he,a as Ne}from"./Step.0811a842.js";function Ce(e){return L({url:"/wf/wfexpre/save",method:"post",data:e})}function we(e){return L({url:"/wf/wfexpre",method:"put",data:e})}function xe(e){return L({url:`/wf/wfexpre/${e}`,method:"get"})}function Ie(e){return L({url:`/wf/wfexpre/${e}`,method:"delete"})}const ke=z({components:{NModal:K,NInput:M,NForm:Z,NFormItem:j,NGrid:H,NGridItem:J,NTreeSelect:Q,NSelect:W,NButton:E,NSpin:Y,NSteps:he,NStep:Ne,NCard:ee},props:{model:{default:{},type:Object}},setup(e,n){const g=x(!1),c=x({}),I=x(1),T=x(),r=V({procdefTypes:[]}),d=x(!1),h=x(null),N=ae(),u=F(),f=(m={})=>{I.value=1,g.value=!0,m.id?(d.value=!0,xe(m.id).then(s=>{c.value={...s,expreTypeName:"\u6761\u4EF6\u8868\u8FBE\u5F0F"}}).finally(s=>{d.value=!1})):c.value={expreParamList:[{paramDesc:"camunda\u4EFB\u52A1id",paramId:"taskId",paramName:"camunda\u4EFB\u52A1id",paramType:"CUSTOMIZE_EXPRE",paramVarType:"string",sequenceNum:0,isDel:0},{paramDesc:"",paramId:"serviceId",paramName:"serviceId",paramType:"CUSTOMIZE_EXPRE",paramVarType:"string",sequenceNum:1,isDel:0},{paramDesc:"",paramId:"bizTag",paramName:"bizTag",paramType:"CUSTOMIZE_EXPRE",paramVarType:"string",sequenceNum:2,isDel:0},{paramDesc:"",paramId:"wfArgs",paramName:"wfArgs",paramType:"CUSTOMIZE_EXPRE",paramVarType:"string",sequenceNum:3,isDel:0},{paramDesc:"",paramId:"seqId",paramName:"\u5E8F\u5217\u6D41",paramType:"CUSTOMIZE_EXPRE",paramVarType:"string",sequenceNum:4,isDel:0}],expreValue:"wfConditionExpression.notify()",expreType:1,expreTypeName:"\u6761\u4EF6\u8868\u8FBE\u5F0F"}},C=async m=>{const s=T.value,p=c.value.expreParamList.length,_={isDel:1,sequenceNum:p};c.value.expreParamList[p]={..._},await s.insertAt(_,-1)},k=m=>{const s=T.value;u.warning({title:"\u8B66\u544A",content:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u9009\u9879\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u4E0D\u786E\u5B9A",onPositiveClick:()=>{s.remove(m)},onNegativeClick:()=>{N.warning("\u53D6\u6D88\u6210\u529F")}})};return le(async()=>{Te({}).then(m=>{r.procdefTypes=m.records.map(s=>(s.label=s.procdefTypeName,s.value=s.id,s))})}),{arrData:r,sonFn:f,xTable:T,insertEvent:C,removeEvent:k,showModal:g,model:c,isLoading:d,current:I,formRef:h,status:V([{label:"\u5426",value:0},{label:"\u662F",value:1}]),typeList:V([{value:1,label:"Boolean"},{value:2,label:"String"},{value:3,label:"Integer"},{value:4,label:"Long"},{value:5,label:"Double"},{value:6,label:"List"}]),paramTypes:V([{label:"\u6807\u51C6(\u5185\u7F6E)",value:"STANDARD_EXPRE"},{label:"\u81EA\u5B9A\u4E49",value:"CUSTOMIZE_EXPRE"}]),paramTypeList:V([{value:"user",label:"\u4EBA\u5458",componentName:"multiModal",componentKey:"user"},{value:"role",label:"\u89D2\u8272",componentName:"roleModal",componentKey:"role"},{value:"duty",label:"\u804C\u52A1",componentName:"multiModal",componentKey:"post"},{value:"post",label:"\u5C97\u4F4D",componentName:"multiModal",componentKey:"job"},{value:"dept",label:"\u90E8\u95E8",componentName:"deptModal",componentKey:"dept"},{value:"mechanism",label:"\u673A\u6784",componentName:"deptModal",componentKey:"mechanism"},{value:"builtinrole",label:"\u8D44\u6E90\u7EC4",componentName:"roleModal",componentKey:"fixedrules"}]),paramVarTypeList2:V([{value:"boolean",label:"Boolean"},{value:"string",label:"String"},{value:"integer",label:"Integer"},{value:"long",label:"Long"},{value:"double",label:"Double"},{value:"date",label:"Date"},{value:"list",label:"List"}]),rules:{procdefTypeName:[{required:!0,message:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u5206\u7C7B\u540D\u79F0",trigger:["input","blur"]}]},onPositiveClick(){const m=c.value.id?we:Ce;h.value.validate(s=>{s||(d.value=!0,m(c.value).then(p=>{p&&(n.emit("update:callback"),c.value={},g.value=!1)}).finally(p=>{d.value=!1}))})},onNegativeClick(){g.value=!1}}},methods:{paramTypeChange(e){this.$refs.xTable.clearActived(),this.$refs.xTable.setActiveCell(e.row,e.column.property),this.model.expreParamList[e._rowIndex].paramType=e.row.paramType,this.model.expreParamList[e._rowIndex].paramVarType=""},paramIdChange(e){this.model.expreParamList[e._rowIndex].paramId=e.row.paramId},seqIdChange(e){this.$refs.xTable.clearActived(),this.$refs.xTable.setActiveCell(e.row,e.column.property),this.model.expreParamList[e._rowIndex].seqId=e.row.seqId},paramVarTypeChange(e){this.$refs.xTable.clearActived(),this.$refs.xTable.setActiveCell(e.row,e.column.property),this.model.expreParamList[e._rowIndex].paramVarType=e.row.paramVarType},paramNameChange(e){this.model.expreParamList[e._rowIndex].paramName=e.row.paramName},procdefTypeChange(e){this.model.procdefTypeId=e,this.arrData.procdefTypes.map(n=>{n.id==e&&(this.model.procdefTypeName=n.label)})}}}),Ve={style:{width:"80%","padding-top":"10px",margin:"auto",height:"40px"}},De=["onClick"],Ee=R("a",{style:{display:"table-cell","vertical-align":"middle"}},"\u6DFB\u52A0",-1),Re=[Ee],Le={style:{padding:"0 5px 5px 0"}};function $e(e,n,g,c,I,T){const r=o("n-step"),d=o("n-steps"),h=o("n-space"),N=o("n-select"),u=o("n-form-item"),f=o("n-grid-item"),C=o("n-input"),k=o("n-grid"),m=o("vxe-option"),s=o("vxe-select"),p=o("vxe-table-column"),_=o("vxe-input"),q=o("vxe-table"),B=o("n-card"),O=o("n-form"),X=o("n-spin"),D=o("n-button"),G=o("n-modal");return y(),b(G,{show:e.showModal,"onUpdate:show":n[11]||(n[11]=t=>e.showModal=t),"mask-closable":!1,preset:"dialog",title:"\u8868\u8FBE\u5F0F\u7BA1\u7406\u7EF4\u62A4",content:"\u4F60\u786E\u8BA4","positive-text":"\u786E\u8BA4","negative-text":"\u53D6\u6D88",style:{width:"1200px"}},{action:l(()=>[R("div",Le,[e.current!==1?(y(),b(D,{key:0,type:"primary",size:"small",style:{"margin-right":"5px"},onClick:n[8]||(n[8]=t=>e.current=--e.current)},{default:l(()=>[v("\u4E0A\u4E00\u6B65")]),_:1})):w("",!0),e.current<2?(y(),b(D,{key:1,type:"primary",size:"small",style:{"margin-right":"5px"},onClick:n[9]||(n[9]=()=>{e.formRef.validate(t=>{t||(e.current=++e.current)})})},{default:l(()=>[v("\u4E0B\u4E00\u6B65")]),_:1})):w("",!0),a(D,{size:"small",type:"default",style:{"margin-right":"5px"},onClick:n[10]||(n[10]=t=>e.showModal=!1)},{default:l(()=>[v("\u53D6\u6D88")]),_:1}),e.current==2?(y(),b(D,{key:2,size:"small",type:"info",onClick:e.onPositiveClick},{default:l(()=>[v("\u4FDD\u5B58")]),_:1},8,["onClick"])):w("",!0)])]),default:l(()=>[a(X,{show:e.isLoading},{default:l(()=>[R("div",Ve,[a(h,{vertical:"",justify:"center"},{default:l(()=>[a(d,{size:"small",current:e.current},{default:l(()=>[a(r,{title:"\u8868\u8FBE\u5F0F\u4FE1\u606F"}),a(r,{title:"\u53C2\u6570\u8BBE\u7F6E"})]),_:1},8,["current"])]),_:1})]),a(O,{model:e.model,ref:"formRef",rules:e.rules,style:{height:"600px"}},{default:l(()=>[e.current==1?(y(),b(k,{key:0,"x-gap":"8",cols:2},{default:l(()=>[a(f,null,{default:l(()=>[a(u,{label:"\u6D41\u7A0B\u5206\u7C7B",path:"procdefTypeId"},{default:l(()=>[a(N,{value:e.model.procdefTypeId,"onUpdate:value":[n[0]||(n[0]=t=>e.model.procdefTypeId=t),n[1]||(n[1]=t=>e.procdefTypeChange(t))],size:"small",placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u5206\u7C7B",options:e.arrData.procdefTypes},null,8,["value","options"])]),_:1})]),_:1}),a(f,null,{default:l(()=>[a(u,{label:"\u8868\u8FBE\u5F0F",path:"expreValue"},{default:l(()=>[a(C,{size:"small",placeholder:"\u8BF7\u8F93\u5165",disabled:"",value:e.model.expreValue,"onUpdate:value":n[2]||(n[2]=t=>e.model.expreValue=t)},null,8,["value"])]),_:1})]),_:1}),a(f,null,{default:l(()=>[a(u,{label:"\u8868\u8FBE\u5F0F\u540D\u79F0",path:"expreName"},{default:l(()=>[a(C,{size:"small",placeholder:"\u8BF7\u8F93\u5165",value:e.model.expreName,"onUpdate:value":n[3]||(n[3]=t=>e.model.expreName=t)},null,8,["value"])]),_:1})]),_:1}),a(f,null,{default:l(()=>[a(u,{label:"\u8FD4\u56DE\u7C7B\u578B",path:"expreReturnType"},{default:l(()=>[a(N,{value:e.model.expreReturnType,"onUpdate:value":n[4]||(n[4]=t=>e.model.expreReturnType=t),size:"small",placeholder:"\u8BF7\u9009\u62E9\u8FD4\u56DE\u7C7B\u578B",options:e.typeList},null,8,["value","options"])]),_:1})]),_:1}),e.model.expreType==1&&e.model.expreReturnType==6?(y(),b(f,{key:0},{default:l(()=>[a(u,{label:"\u6CDB\u578B",path:"expreReturnGenerics"},{default:l(()=>[a(N,{value:e.model.expreReturnGenerics,"onUpdate:value":n[5]||(n[5]=t=>e.model.expreReturnGenerics=t),size:"small",placeholder:"\u8BF7\u9009\u62E9\u6CDB\u578B",options:e.typeList},null,8,["value","options"])]),_:1})]),_:1})):w("",!0),a(f,{span:"24"},{default:l(()=>[a(u,{label:"\u8868\u8FBE\u5F0F\u63CF\u8FF0",path:"remark"},{default:l(()=>[a(C,{size:"small",placeholder:"\u8BF7\u8F93\u5165",type:"textarea",value:e.model.remark,"onUpdate:value":n[6]||(n[6]=t=>e.model.remark=t)},null,8,["value"])]),_:1})]),_:1})]),_:1})):w("",!0),e.current==2?(y(),b(k,{key:1,"x-gap":"24",cols:1},{default:l(()=>[a(f,null,{default:l(()=>[a(B,{style:{height:"600px"}},{action:l(()=>[R("div",{style:{"text-align":"center",display:"table",width:"100%",height:"100%",cursor:"pointer"},onClick:n[7]||(n[7]=(...t)=>e.insertEvent&&e.insertEvent(...t))},Re)]),default:l(()=>[a(q,{border:"",resizable:"","keep-source":"","show-overflow":"",ref:"xTable",size:"small",height:"auto","edit-rules":e.validRules,"edit-config":{trigger:"click",mode:"cell",showStatus:!0,autoClear:!1},data:e.model.expreParamList},{default:l(()=>[a(p,{field:"paramVarType",title:"\u53C2\u6570\u7C7B\u578B","edit-render":{}},{edit:l(t=>[a(s,{onChange:i=>e.paramVarTypeChange(t),modelValue:t.row.paramVarType,"onUpdate:modelValue":i=>t.row.paramVarType=i,placeholder:"",size:"small",disabled:t.row.isDel==0},{default:l(()=>[(y(!0),P(S,null,te(t.row.paramType=="STANDARD_EXPRE"?e.paramTypeList:e.paramVarTypeList2,i=>(y(),b(m,{key:i.value,value:i.value,label:i.label},null,8,["value","label"]))),128))]),_:2},1032,["onChange","modelValue","onUpdate:modelValue","disabled"])]),default:l(({row:t})=>[v($(t.paramVarType?(t.paramType=="STANDARD_EXPRE"?e.paramTypeList:e.paramVarTypeList2).filter(i=>i.value==t.paramVarType)[0].label:""),1)]),_:1}),a(p,{field:"paramId",title:"\u53C2\u6570ID","edit-render":{}},{edit:l(t=>[a(_,{onChange:i=>e.paramIdChange(t),modelValue:t.row.paramId,"onUpdate:modelValue":i=>t.row.paramId=i,placeholder:"",size:"small",disabled:t.row.isDel==0},null,8,["onChange","modelValue","onUpdate:modelValue","disabled"])]),default:l(({row:t})=>[v($(t.paramId),1)]),_:1}),a(p,{field:"paramName",title:"\u53C2\u6570\u540D\u79F0","edit-render":{}},{edit:l(t=>[a(_,{onChange:i=>e.paramNameChange(t),modelValue:t.row.paramName,"onUpdate:modelValue":i=>t.row.paramName=i,placeholder:"",size:"small",disabled:t.row.isDel==0},null,8,["onChange","modelValue","onUpdate:modelValue","disabled"])]),default:l(({row:t})=>[v($(t.paramName),1)]),_:1}),a(p,{title:"\u64CD\u4F5C",align:"center"},{default:l(({row:t})=>[t.isDel==1?(y(),P("a",{key:0,style:{color:"red",cursor:"pointer"},onClick:i=>e.removeEvent(t)},"\u5220\u9664",8,De)):w("",!0)]),_:1})]),_:1},8,["edit-rules","data"])]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1},8,["model","rules"])]),_:1},8,["show"])]),_:1},8,["show"])}const Pe=U(ke,[["render",$e]]),Ae=z({components:{NLayout:ne,NLayoutHeader:oe,NLayoutContent:re,NButton:E,NSpace:se,NwIcon:pe,NTag:ie,NInput:M,NInputGroup:ue,NDrawer:de,NDrawerContent:me,NwFunctionAccess:be,NwFunctionPredefine:ce,ExpreAction:Pe},setup(){const e=F(),n=x(),{bind:g,gridRef:c,filterData:I,query:T,reset:r}=new fe.VxeGridPaging({columns:[{field:"procdefTypeName",title:"\u6D41\u7A0B\u5206\u7C7B"},{field:"expreValue",title:"\u8868\u8FBE\u5F0F"},{field:"expreName",title:"\u8868\u8FBE\u5F0F\u540D\u79F0",showOverflow:!0},{title:"\u64CD\u4F5C",showHeaderOverflow:!0,width:"140px",slots:{default:({row:d})=>[A(E,{type:"warning",size:"tiny",style:"margin-right: 5px;",onClick:()=>{n.value.sonFn(d)}},"\u7F16\u8F91"),A(E,{size:"tiny",type:"error",onClick:()=>{e.error({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u53D6\u6D88",maskClosable:!1,onMaskClick:()=>{},onPositiveClick:()=>{Ie(d.id).then(h=>{r()})}})}},{default:()=>"\u5220\u9664"})]}}]},new ye("/wf/wfexpre/list","post"));return ve().then(()=>{r({})}),{bind:g,gridRef:c,filterData:I,expreAction:n,query:T,reset:r,handleCreate(){n.value.sonFn()},refresh(){r({})}}}});function ze(e,n,g,c,I,T){const r=o("n-button"),d=o("n-space"),h=o("n-input"),N=o("n-input-group"),u=o("nw-icon"),f=o("n-layout-header"),C=o("vxe-grid"),k=o("n-layout-content"),m=o("n-layout"),s=o("ExpreAction");return y(),P(S,null,[a(m,{class:"nw-layout-full"},{default:l(()=>[a(f,{class:"nw-layout-header"},{default:l(()=>[a(d,{size:5,style:{padding:"0 5px"}},{default:l(()=>[a(r,{onClick:e.handleCreate,size:"small",type:"primary"},{default:l(()=>[v("\u65B0\u5EFA\u4E8B\u4EF6")]),_:1},8,["onClick"])]),_:1}),a(d,{size:5,style:{padding:"0 5px"}},{default:l(()=>[a(N,null,{default:l(()=>[a(h,{value:e.filterData.formNameCh||"","onUpdate:value":n[0]||(n[0]=p=>e.filterData.formNameCh=p),placeholder:"\u8F93\u5165\u67E5\u8BE2\u6587\u672C",style:{width:"150px"}},null,8,["value"]),a(r,{type:"primary",onClick:n[1]||(n[1]=p=>e.query())},{default:l(()=>[v(" \u641C\u7D22 ")]),_:1})]),_:1}),a(r,{title:"\u91CD\u7F6E",type:"warning",onClick:n[2]||(n[2]=p=>e.reset())},{icon:l(()=>[a(u,{name:"icon-n-y-refresh"})]),_:1}),a(r,{title:"\u5BFC\u5165"},{icon:l(()=>[a(u,{name:"icon-n-y-import"})]),_:1}),a(r,{title:"\u5BFC\u51FA"},{icon:l(()=>[a(u,{name:"icon-n-y-export"})]),_:1}),a(r,{title:"\u6253\u5370",onClick:n[3]||(n[3]=p=>{var _;return(_=e.gridRef)==null?void 0:_.print()})},{icon:l(()=>[a(u,{name:"icon-n-y-print"})]),_:1}),a(r,null,{icon:l(()=>[a(u,{name:"icon-n-y-column"})]),_:1})]),_:1})]),_:1}),a(k,null,{default:l(()=>[a(C,ge(e.bind,{ref:"gridRef"}),null,16)]),_:1})]),_:1}),a(s,{ref:"expreAction","onUpdate:callback":n[4]||(n[4]=()=>{e.refresh()})},null,512)],64)}const Me=U(Ae,[["render",ze],["__scopeId","data-v-4203224d"]]);_e(Me).mount("#app");
