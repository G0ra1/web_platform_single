var H=Object.defineProperty;var P=(t,n,d)=>n in t?H(t,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[n]=d;var h=(t,n,d)=>(P(t,typeof n!="symbol"?n+"":n,d),d);import{r,a7 as T,l as Y,d as K,m as Z,N as X,E as J,k as Q,G as A,j as ee,h as ae,a8 as ne,B as q,W as V,a9 as te,aa as ue,_ as le,I as y,o as F,b as k,w as l,a as s,e as ie,a6 as R,g as m,t as c,c as N,F as oe,ab as se,f as j,ac as de,ad as re,p as ce}from"./index.e51afe9d.js";import{c as me,a as pe,b as he,d as ge}from"./index.ec671df2.js";import{A as ve}from"./index.f2e37b57.js";import{N as ye}from"./FormItemGridItem.d78d7d10.js";import{N as fe}from"./InputNumber.9cc11044.js";const _e={tianbaochangbie:{name:"tianbaochangbie",type:"string",description:"\u586B\u62A5\u5382\u522B",example:"",exampleSetFlag:!0},tianbaochangbieId:{name:"tianbaochangbieId",type:"string",description:"\u586B\u62A5\u5382\u522BId",example:"",exampleSetFlag:!0},tianbaoshijian:{name:"tianbaoshijian",type:"string",description:"\u586B\u62A5\u65F6\u95F4",example:"",exampleSetFlag:!0},tianbaoren:{name:"tianbaoren",type:"string",description:"\u586B\u62A5\u4EBA",example:"",exampleSetFlag:!0},tianbaorenId:{name:"tianbaorenId",type:"string",description:"\u586B\u62A5\u4EBAId",example:"",exampleSetFlag:!0},tianbaorendanwei:{name:"tianbaorendanwei",type:"string",description:"\u586B\u62A5\u4EBA\u5355\u4F4D",example:"",exampleSetFlag:!0},tianbaorendanweiId:{name:"tianbaorendanweiId",type:"string",description:"\u586B\u62A5\u4EBAId",example:"",exampleSetFlag:!0},sourceList:{name:"sourceList",type:"array",description:"sourceList",items:{name:"\u65E5\u62A5\u6765\u6E90 Dto",title:"\u65E5\u62A5\u6765\u6E90 Dto",type:"object",properties:{laiyuan_code:{name:"laiyuan_code",type:"string",description:"\u6765\u6E90(\u7F16\u7801)"},laiyuan_name:{name:"laiyuan_name",type:"string",description:"\u6765\u6E90(\u540D\u79F0)"},yunxiaoliang:{name:"yunxiaoliang",type:"number",description:"\u8FD0\u9500\u91CF"},beizhu:{name:"beizhu",type:"string",description:"\u5907\u6CE8"}}}},detailList:{name:"detailList",type:"array",description:"detailList",items:{name:"\u65E5\u62A5\u4FE1\u606F Dto",title:"\u65E5\u62A5\u4FE1\u606F Dto",type:"object",properties:{changzhan_quyu_code:{name:"changzhan_quyu_code",type:"string",description:"\u573A\u7AD9/\u533A\u57DF(\u7F16\u7801)"},changzhan_quyu_name:{name:"changzhan_quyu_name",type:"string",description:"\u573A\u7AD9/\u533A\u57DF(\u540D\u79F0)"},tianranqileixing_code:{name:"tianranqileixing_code",type:"string",description:"\u5929\u7136\u6C14\u7C7B\u578B(\u7F16\u7801)"},tianranqileixing_name:{name:"tianranqileixing_name",type:"string",description:"\u5929\u7136\u6C14\u7C7B\u578B(\u540D\u79F0)"},yonghu_code:{name:"yonghu_code",type:"string",description:"\u7528\u6237(\u7F16\u7801)"},yonghu_name:{name:"yonghu_name",type:"string",description:"\u7528\u6237(\u540D\u79F0)"},yunxiaoliang:{name:"yonghu",type:"number",description:"\u8FD0\u9500\u91CF"},beizhu:{name:"beizhu",type:"string",description:"\u5907\u6CE8"}}}}};class be extends ve{constructor(){super();h(this,"formRef",r());h(this,"dataModel",r({}));h(this,"rules",r({}));h(this,"brules",r({}));h(this,"getSchema",async()=>_e);h(this,"setValue",async d=>{d.tianbaoshijian&&(d.tianbaoshijian=T(new Date,"yyyy-MM-dd")),this.dataModel.value=d,console.log(this.dataModel.value,"this.dataModel.value")});h(this,"getValue",async()=>Y.exports.cloneDeep(this.dataModel.value));h(this,"setRules",d=>{this.rules.value={},Object.entries(d).forEach(([g,b])=>{g.includes(".")||(b.powerCode==="required"?this.rules.value[g]={required:!0,trigger:["blur","input"],message:`${b.nameCh}\u8BE5\u5C5E\u6027\u4E3A\u5FC5\u586B`}:this.brules.value[g]=b.powerCode)})});h(this,"validate",async()=>{var g;let d=[];return await((g=this.formRef.value)==null?void 0:g.validate().then(()=>{d=[]}).catch(b=>{d=b.map(B=>B[0].message)})),d})}}const Ce=K({components:{NForm:Z,NFormItem:X,NGrid:J,NFormItemGi:ye,NInput:Q,NInputNumber:fe,NButton:A,NDatePicker:ee,NSelect:ae,NTreeSelect:ne},setup(){const{formRef:t,dataModel:n,rules:d,brules:g,setValue:b,getValue:B,validate:D,setRules:v}=new be,C=(a,u)=>{if(a&&a.length<=0)return 0;let _=0;return a.forEach(z=>{console.log(z),console.log(u),z[u]&&(_+=Number(z[u]))}),_},w=r(0),p=r(null),f=r(null),x=r([]),I=({row:a,column:u})=>{a.tianranqileixing_name=x.value.filter(_=>_.value==a.tianranqileixing_code)[0].label},E=r([]),e=({row:a,column:u})=>{a.laiyuan_name=E.value.filter(_=>_.value==a.laiyuan_code)[0].label},i=r([]),o=(a,{row:u,column:_})=>{u.changzhan_quyu_code=a,console.log(i.value),console.log(u.changzhan_quyu_code),u.changzhan_quyu_name=i.value.filter(z=>z.value==u.changzhan_quyu_code)[0].label},M=r([]),G=(a,{row:u,column:_})=>{console.log(a),u.yonghu_code=a,u.yonghu_name=M.value.filter(z=>z.value==u.yonghu_code)[0].label};v({sumBudgetExecuteAmount:{powerCode:"required",nameCh:"\u6D4B\u8BD5"}});const O=r({rowId:"id",rowKey:!1,keepSource:!0,size:"mini",autoResize:!0,showOverflow:!1,highlightHoverRow:!0,border:!0,data:n.value.sourceList,showFooter:!0,toolbarConfig:{slots:{buttons:({$grid:a})=>[q(A,{type:"primary",onClick:function(){n.value.sourceList||(n.value.sourceList=[]),n.value.sourceList.push({id:`${new Date().getTime()}`}),a.reloadData(n.value.sourceList)}},{default:()=>"\u65B0\u589E"})]}},editConfig:{trigger:"click",mode:"cell",showStatus:!0,autoClear:!1},columns:[{title:"\u6765\u6E90",field:"laiyuan_name",showOverflow:"title",minWidth:200,editRender:{},slots:{default:"laiyuan_default",edit:"laiyuan_edit"}},{title:"\u8FD0\u9500\u91CF",field:"yunxiaoliang",minWidth:190,editRender:{},slots:{default:"yunxiaoliang_default",edit:"yunxiaoliang_edit"}},{title:"\u5907\u6CE8",field:"beizhu",minWidth:150,editRender:{},slots:{default:"beizhu_default",edit:"beizhu_edit"}},{title:"\u64CD\u4F5C",width:70,fixed:"right",slots:{default:({$table:a,rowIndex:u})=>[q(A,{size:"small",type:"error",onClick:function(){n.value.sourceList.splice(u,1),a.reloadData(n.value.sourceList)}},{default:()=>"\u5220\u9664"})]}}]}),$=r({rowId:"id",rowKey:!1,keepSource:!1,size:"mini",showOverflow:!1,highlightHoverRow:!0,border:!0,data:n.value.detailList,toolbarConfig:{slots:{buttons:({$grid:a})=>[q(A,{type:"primary",onClick:function(){n.value.detailList||(n.value.detailList=[]),n.value.detailList.push({id:`${new Date().getTime()}`}),a.reloadData(n.value.detailList)}},{default:()=>"\u65B0\u589E"})]}},editConfig:{trigger:"click",mode:"cell",showStatus:!0,autoClear:!1},columns:[{title:"\u573A\u7AD9",field:"changzhan_quyu_name",showOverflow:"title",minWidth:200,editRender:{},slots:{default:"changzhan_default",edit:"changzhan_edit"}},{title:"\u5929\u7136\u6C14\u7C7B\u578B",field:"tianranqileixing_name",showOverflow:"title",minWidth:200,editRender:{},slots:{default:"tianranqileixing_default",edit:"tianranqileixing_edit"}},{title:"\u7528\u6237",field:"yonghu_name",showOverflow:"title",minWidth:200,editRender:{},slots:{default:"yonghu_default",edit:"yonghu_edit"}},{title:"\u8FD0\u9500\u91CF",field:"yunxiaoliang",minWidth:190,editRender:{},slots:{default:"yunxiaoliang_default",edit:"yunxiaoliang_edit"}},{title:"\u5907\u6CE8",field:"beizhu",minWidth:150,editRender:{},slots:{default:"beizhu_default",edit:"beizhu_edit"}},{title:"\u64CD\u4F5C",width:70,fixed:"right",slots:{default:({$table:a,rowIndex:u})=>[q(A,{size:"small",type:"error",onClick:function(){n.value.detailList.splice(u,1),a.reloadData(n.value.detailList)}},{default:()=>"\u5220\u9664"})]}}]}),L=r([]),S=r({});V(()=>n.value.detailList,a=>{p.value&&(p.value.loadData(a),U())}),V(()=>n.value.sourceList,a=>{f.value&&f.value.loadData(a)}),te(()=>{ue.get("userInfo").then(a=>{n.value.tianbaochangbie||(n.value.tianbaochangbie=a.parentDeptName,n.value.tianbaochangbieId=a.parentDeptId,n.value.tianbaorendanwei=a.orgFullName,n.value.tianbaorendanweiId=a.orgFullId,n.value.tianbaoren=a.userNameCh,n.value.tianbaorenId=a.id),n.value.tianbaoshijian||(n.value.tianbaoshijian=T(new Date,"yyyy-MM-dd")),console.log("\u7528\u6237\u4FE1\u606F",a)}),me().then(a=>{console.log(a,"\u6765\u6E90++++++++"),E.value=a.map(u=>({label:u.pgtCustomName,value:u.pgtCustomCode}))}),pe().then(a=>{console.log(a,"\u573A\u7AD9............"),i.value=a.map(u=>({label:u.stationName,value:u.stationCode}))}),he().then(a=>{console.log(a,"\u7528\u6237............"),M.value=a.map(u=>({label:u.customName,value:u.customCode}))}),ge("NATGAS_TYPE").then(a=>{x.value=a.map(u=>({value:u.dictItemCode,label:u.dictItemName}))})});const W=()=>{f.value&&f.value.clearEdit(),p.value&&p.value.clearEdit(),U()},U=()=>{n.value.detailList&&(L.value=Array.from(new Set(n.value.detailList.map(a=>a.tianranqileixing_name||""))),L.value.forEach(a=>{n.value.detailList&&(S.value[a]=C(n.value.detailList.filter(u=>a==u.tianranqileixing_name),"yunxiaoliang"))}),console.log(S.value,L.value))};return{formRef:t,dataModel:n,rules:d,brules:g,validate:D,testshow:()=>{B().then(a=>{console.log(a)}),D().then(a=>{})},sourceListGridOption:O,detailListGridOption:$,detailVxeGrid:p,sourceVxeGrid:f,hbxsgsq:E,hbxsgsqChangeEvent:e,changCZ:i,changYH:M,changzhanChangeEvent:o,tianranqileixingChangeEvent:I,natgasType:x,yonghuChangeEvent:G,clearActive:W,natgasTypeList:L,natgasTypeSum:S,calcYX:U,activeNum:w,sumNum:C}}});const ze=t=>(de("data-v-43c1b9a7"),t=t(),re(),t),Fe={class:"heji"},xe=ze(()=>m("span",null,"\u6CB3\u5317\u9500\u552E\u7BA1\u8F93\u6C14:",-1)),Ee={class:"num"},Ae={class:"heji"},Be={key:0,class:"label"},De={key:1,class:"num"};function Le(t,n,d,g,b,B){const D=y("n-date-picker"),v=y("n-form-item-gi"),C=y("n-input"),w=y("n-button"),p=y("n-select"),f=y("n-input-number"),x=y("vxe-grid"),I=y("n-grid"),E=y("n-form");return F(),k(E,{model:t.dataModel,rules:t.rules,ref:"formRef","label-placement":"left","label-width":160,size:"small",style:{padding:"45px"}},{default:l(()=>[s(I,{cols:24,"x-gap":24},{default:l(()=>[s(v,{span:8,label:"\u586B\u62A5\u65E5\u671F",path:"tianbaoshijian"},{default:l(()=>[s(D,{"formatted-value":t.dataModel.tianbaoshijian,"onUpdate:formatted-value":n[0]||(n[0]=e=>t.dataModel.tianbaoshijian=e),"value-format":"yyyy-MM-dd",type:"date"},null,8,["formatted-value"])]),_:1}),s(v,{span:8,label:"\u586B\u62A5\u5382\u522B",path:"tianbaochangbie"},{default:l(()=>[s(C,{placeholder:"\u586B\u62A5\u5382\u522B",disabled:"",value:t.dataModel.tianbaochangbie,"onUpdate:value":n[1]||(n[1]=e=>t.dataModel.tianbaochangbie=e)},null,8,["value"])]),_:1}),s(v,{span:8,label:"\u586B\u62A5\u4EBA",path:"tianbaoren"},{default:l(()=>[s(C,{placeholder:"\u586B\u62A5\u4EBA",disabled:"",value:t.dataModel.tianbaoren,"onUpdate:value":n[2]||(n[2]=e=>t.dataModel.tianbaoren=e)},null,8,["value"])]),_:1}),s(v,{span:24,label:"\u6CB3\u5317\u9500\u552E\u7BA1\u8F93\u6C14"},{default:l(()=>[t.dataModel.tianbaochangbieId=="239"&&t.activeNum==0?(F(),k(w,{key:0,type:"primary",onClick:n[3]||(n[3]=e=>t.activeNum++)},{default:l(()=>[ie("+ ")]),_:1})):(F(),k(x,R({key:1,ref:"sourceVxeGrid"},t.sourceListGridOption,{style:{"moz-user-select":"-moz-none","-moz-user-select":"none","-o-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none",width:"100%"}}),{laiyuan_default:l(({row:e,column:i})=>[m("span",null,c(e.laiyuan_name),1)]),laiyuan_edit:l(({row:e,column:i})=>[s(p,{placeholder:"\u8BF7\u9009\u62E9\u6765\u6E90",value:e.laiyuan_code,"onUpdate:value":[o=>e.laiyuan_code=o,o=>t.hbxsgsqChangeEvent({row:e,column:i})],options:t.hbxsgsq},null,8,["value","onUpdate:value","options"])]),yunxiaoliang_default:l(({row:e,column:i})=>[m("span",null,c(e.yunxiaoliang),1)]),yunxiaoliang_edit:l(({row:e,column:i})=>[s(f,{placeholder:"\u8BF7\u8F93\u5165\u8FD0\u9500\u91CF",onBlur:t.clearActive,value:e.yunxiaoliang,"onUpdate:value":o=>e.yunxiaoliang=o},null,8,["onBlur","value","onUpdate:value"])]),beizhu_default:l(({row:e,column:i})=>[m("span",null,c(e.beizhu),1)]),beizhu_edit:l(({row:e,column:i})=>[s(C,{placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",onBlur:t.clearActive,value:e.beizhu,"onUpdate:value":o=>e.beizhu=o},null,8,["onBlur","value","onUpdate:value"])]),_:1},16))]),_:1}),s(v,{span:24,label:"\u5408\u8BA1"},{default:l(()=>[m("span",Fe,[xe,m("span",Ee,c(t.sumNum(t.dataModel.sourceList||[],"yunxiaoliang")),1)])]),_:1}),s(v,{span:24,label:"\u534E\u5317\u6CB9\u7530\u5180\u4E2D\u81EA\u4EA7\u6C14"},{default:l(()=>[s(x,R({ref:"detailVxeGrid"},t.detailListGridOption,{style:{"moz-user-select":"-moz-none","-moz-user-select":"none","-o-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none",width:"100%"}}),{changzhan_default:l(({row:e,column:i})=>[m("span",null,c(e.changzhan_quyu_name),1)]),changzhan_edit:l(({row:e,column:i})=>[s(p,{placeholder:"\u8BF7\u9009\u62E9\u573A\u7AD9",options:t.changCZ,modelValue:e.changzhan_quyu_code,"onUpdate:modelValue":o=>e.changzhan_quyu_code=o,modelModifiers:{value:!0},"onUpdate:value":o=>t.changzhanChangeEvent(o,{row:e,column:i})},null,8,["options","modelValue","onUpdate:modelValue","onUpdate:value"])]),tianranqileixing_default:l(({row:e,column:i})=>[m("span",null,c(e.tianranqileixing_name),1)]),tianranqileixing_edit:l(({row:e,column:i})=>[s(p,{placeholder:"\u9009\u62E9\u5929\u7136\u6C14\u7C7B\u578B",size:"small",value:e.tianranqileixing_code,"onUpdate:value":[o=>e.tianranqileixing_code=o,o=>t.tianranqileixingChangeEvent({row:e,column:i})],options:t.natgasType},null,8,["value","onUpdate:value","options"])]),yonghu_default:l(({row:e,column:i})=>[m("span",null,c(e.yonghu_name),1)]),yonghu_edit:l(({row:e,column:i})=>[s(p,{placeholder:"\u8BF7\u9009\u62E9\u7528\u6237",options:t.changYH,modelValue:e.yonghu_code,"onUpdate:modelValue":o=>e.yonghu_code=o,modelModifiers:{value:!0},"onUpdate:value":o=>t.yonghuChangeEvent(o,{row:e,column:i})},null,8,["options","modelValue","onUpdate:modelValue","onUpdate:value"])]),yunxiaoliang_default:l(({row:e,column:i})=>[m("span",null,c(e.yunxiaoliang),1)]),yunxiaoliang_edit:l(({row:e,column:i})=>[s(f,{placeholder:"\u8BF7\u8F93\u5165\u8FD0\u9500\u91CF",onBlur:t.clearActive,value:e.yunxiaoliang,"onUpdate:value":o=>e.yunxiaoliang=o},null,8,["onBlur","value","onUpdate:value"])]),beizhu_default:l(({row:e,column:i})=>[m("span",null,c(e.beizhu),1)]),beizhu_edit:l(({row:e,column:i})=>[s(C,{placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",onBlur:t.clearActive,value:e.beizhu,"onUpdate:value":o=>e.beizhu=o},null,8,["onBlur","value","onUpdate:value"])]),_:1},16)]),_:1}),s(v,{span:24,label:"\u5408\u8BA1"},{default:l(()=>[(F(!0),N(oe,null,se(t.natgasTypeList,e=>(F(),N("span",Ae,[e?(F(),N("span",Be,c(e)+":",1)):j("",!0),e?(F(),N("span",De,c(t.natgasTypeSum?t.natgasTypeSum[e]:""),1)):j("",!0)]))),256))]),_:1})]),_:1})]),_:1},8,["model","rules"])}const qe=le(Ce,[["render",Le],["__scopeId","data-v-43c1b9a7"]]);ce(qe).mount("#app");
